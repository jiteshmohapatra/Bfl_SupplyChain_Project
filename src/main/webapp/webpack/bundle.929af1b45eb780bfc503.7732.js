/*! For license information please see bundle.929af1b45eb780bfc503.7732.js.LICENSE.txt */
"use strict";(self.webpackChunkopenboxes=self.webpackChunkopenboxes||[]).push([[7732],{37732:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ge});var r=n(96540),o=n(34860),a=n(5556),i=n.n(a),l=n(41357),u=n(42164),c=n(50709),s=n(14044),d=n(44088),f=n(79352),m=n(26216),v=function(e){var t=e.printCountForm,n=e.next,o=e.save;return r.createElement("div",{className:"d-flex justify-content-sm-between align-items-end"},r.createElement(f.A,{label:"react.cycleCount.redirectToList.label",defaultMessage:"Back to Cycle Count List",redirectTo:c.BC.list(s.Wg),className:"pt-5"}),r.createElement("div",{className:"d-flex gap-8"},r.createElement("div",{className:"btn-group"},r.createElement(u.A,{isDropdown:!0,defaultLabel:"Print count form",label:"react.cycleCount.printCountForm.label",variant:"primary-outline",StartIcon:r.createElement(l.GD9,{size:18})}),r.createElement("div",{className:"dropdown-menu dropdown-menu-right nav-item padding-8","aria-labelledby":"dropdownMenuButton"},r.createElement("a",{href:"#",className:"dropdown-item",onClick:function(){return t(d.A.PDF)},role:"button"},r.createElement(m.A,{id:"react.cycleCount.printCountFormPdf.label",defaultMessage:"Print Count form PDF"})),r.createElement("a",{href:"#",className:"dropdown-item",onClick:function(){return t(d.A.XLS)},role:"button"},r.createElement(m.A,{id:"react.cycleCount.exportCountSheet.label",defaultMessage:"Export Count sheet"})))),r.createElement(u.A,{onClick:o,label:"react.cycleCount.save.label",defaultLabel:"Save progress",variant:"primary",StartIcon:r.createElement(l.vUL,{size:18})}),r.createElement(u.A,{onClick:n,label:"react.default.button.next.label",defaultLabel:"Next",variant:"primary"})))};const p=v;v.propTypes={printCountForm:i().func.isRequired,next:i().func.isRequired,save:i().func.isRequired};var y=n(697),b=n(51836),h=n(56934),C=n(82486),g=n(62326),E=n(67911),w=n(80077),A=n(62775),N=n(33888),I=n(2543),O=n.n(I),x=n(61965),D=n(26409),R=n(87054),S=n(19622),T=n(52725),L=n(15516),j=n(20531),k=n(85728),_=n(78093);function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},P.apply(null,arguments)}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return q(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var M=n(91019),F=function(e){var t,n,o=e.id,a=e.product,i=e.dateCounted,c=e.tableData,s=e.tableMeta,d=e.addEmptyRow,f=e.removeRow,m=e.assignCountedBy,v=e.validationErrors,p=e.setCountedDate,I=e.isStepEditable,q=e.countedBy,F=e.defaultCountedBy,Y=e.isFormValid,U=e.refreshFocusCounter,V=e.triggerValidation,z=(0,L.A)(),W=(0,y.d4)((function(e){return e.localize})),G=(0,M.Yq)(W),Q=function(e){var t=e.cycleCountId,n=e.productId,o=e.removeRow,a=e.validationErrors,i=e.tableData,u=e.isStepEditable,c=e.formatLocalizedDate,s=e.addEmptyRow,d=e.triggerValidation,f=e.refreshFocusCounter,m=(0,N.FB)(),v=B((0,r.useState)(null),2),p=v[0],h=v[1],C=B((0,r.useState)(null),2),g=C[0],I=C[1],q=B((0,r.useState)(0),2),M=q[0],F=q[1],Y=(0,L.A)(),U=(0,y.d4)((function(e){return{users:e.users.data,binLocations:e.cycleCount.binLocations,currentLocation:e.session.currentLocation}})),V=U.users,z=U.currentLocation,W=U.binLocations;(0,r.useEffect)((function(){f!==M&&(h(null),I(null),F(f))}),[f]);var G=(0,r.useMemo)((function(){return(0,k.Wx)(z.supportedActivities)}),[null==z?void 0:z.id]),Q={cell:function(e){var o,f=e.row,m=f.original,v=f.index,y=e.column.id,b=e.table,C=y.replaceAll("_","."),N=O().get(i,"[".concat(v,"].").concat(C)),D=B((0,r.useState)(N),2),L=D[0],k=D[1],q=!m.id.includes("newRow")&&![S.A.QUANTITY_COUNTED,S.A.COMMENT].includes(y);if(!u)return r.createElement(x.n,{className:"static-cell-count-step d-flex align-items-center"},function(e,t){var n=e.replaceAll("_",".");return n===S.A.EXPIRATION_DATE?c(t,A.o.DD_MMM_YYYY):n===S.A.QUANTITY_COUNTED?null==t?void 0:t.toString():n===S.A.BIN_LOCATION&&G?null==t?void 0:t.name:t}(y,L));var M=null==a||null===(o=a[t])||void 0===o||null===(o=o.errors)||void 0===o||null===(o=o[v])||void 0===o||null===(o=o[C])||void 0===o?void 0:o._errors,F=B((0,r.useState)(M),2),U=F[0],V=F[1],z=N!==L,Q=function(){var e;if(z){if(C===S.A.QUANTITY_COUNTED){var n,r=L?parseInt(L,10)||0:L;return k(r),null===(n=b.options.meta)||void 0===n||n.updateData(t,m.id,y,r),V(null),void d()}null===(e=b.options.meta)||void 0===e||e.updateData(t,m.id,y,L),V(null),d()}};(0,r.useEffect)((function(){null!==p&&g&&null!==U&&V(null)}),[p,g]),(0,r.useEffect)((function(){var e;null===(e=b.options.meta)||void 0===e||e.updateData(t,m.id,y,L)}),[L]);var X,K=C===S.A.QUANTITY_COUNTED?"number":"text",$=(X=C)===S.A.EXPIRATION_DATE?E.A:X===S.A.BIN_LOCATION?w.A:R.A,H=function(e){return e===S.A.BIN_LOCATION&&G?{labelKey:"name",options:(0,j.A)(W)}:e===S.A.EXPIRATION_DATE?{customDateFormat:A.o.DD_MMM_YYYY}:{}}(C),Z=C===S.A.BIN_LOCATION,J=[S.A.LOT_NUMBER,S.A.EXPIRATION_DATE,S.A.QUANTITY_COUNTED,S.A.COMMENT];G&&J.splice(0,0,S.A.BIN_LOCATION);var ee=[S.A.QUANTITY_COUNTED,S.A.COMMENT],te=(0,T.A)({newRowFocusableCells:J,existingRowFocusableCells:ee,tableData:i,setColumnId:I,setRowIndex:h,addNewRow:function(){return s(n,t,!1)},isNewRow:function(e){var t;return null==e||null===(t=e.id)||void 0===t?void 0:t.includes("newRow")},onBlur:Q}).handleKeyDown;return r.createElement(x.n,{className:"rt-td rt-td-count-step pb-0",tooltip:Z,tooltipForm:Z,tooltipClassname:Z&&"bin-location-tooltip",tooltipLabel:(null==L?void 0:L.name)||Y("react.cycleCount.table.binLocation.label","Bin Location")},r.createElement($,P({disabled:q,type:K,value:L,onChange:function(e){var t,n;k(null!==(t=null==e||null===(n=e.target)||void 0===n?void 0:n.value)&&void 0!==t?t:e)},onBlur:Q,className:"m-1 hide-arrows ".concat(Z?"w-99":"w-75"," ").concat(U&&"border border-danger input-has-error"),showErrorBorder:U,hideErrorMessageWrapper:!0,onKeyDown:function(e){return te(e,v,C)},focusProps:{fieldIndex:v,fieldId:C,rowIndex:p,columnId:g},onWheel:function(e){return e.currentTarget.blur()}},H)),U&&r.createElement(_.A,{content:U,className:"tooltip-icon tooltip-icon--error",icon:l.sFm}))}};return{columns:[m.accessor((function(e){var t,n;return null!=e&&null!==(t=e.binLocation)&&void 0!==t&&t.label?null==e?void 0:e.binLocation:null===(n=e.binLocation)||void 0===n?void 0:n.name}),{id:S.A.BIN_LOCATION,header:function(){return r.createElement(D.A,{className:"rt-th-count-step"},Y("react.cycleCount.table.binLocation.label","Bin Location"))},meta:{flexWidth:100,hide:!G}}),m.accessor(S.A.LOT_NUMBER,{header:function(){return r.createElement(D.A,{className:"rt-th-count-step"},Y("react.cycleCount.table.lotNumber.label","Serial / Lot Number"))},meta:{flexWidth:100}}),m.accessor(S.A.EXPIRATION_DATE,{header:function(){return r.createElement(D.A,null,Y("react.cycleCount.table.expirationDate.label","Expiration Date"))},meta:{flexWidth:100,getCellContext:function(){return{className:"split-table-right"}}}}),m.accessor(S.A.QUANTITY_COUNTED,{header:function(){return r.createElement(D.A,{className:"rt-th-count-step"},Y("react.cycleCount.table.quantityCounted.label","Quantity Counted"))},meta:{flexWidth:50}}),m.accessor(S.A.COMMENT,{header:function(){return r.createElement(D.A,{className:"rt-th-count-step"},Y("react.cycleCount.table.comment.label","Comment"))},meta:{flexWidth:100}}),m.accessor(null,{id:S.A.ACTIONS,header:function(){return r.createElement(D.A,null)},cell:function(e){var n=e.row.original;return r.createElement(x.n,{className:"rt-td d-flex justify-content-center count-step-actions"},r.createElement(b.Tooltip,{arrow:"true",delay:"150",duration:"250",hideDelay:"50",className:"text-overflow-ellipsis",html:r.createElement("span",{className:"p-2"},Y("react.default.button.delete.label","Delete")),disabled:n.id},(n.id.includes("newRow")||n.custom)&&u&&r.createElement(l.WFf,{className:"cursor-pointer",onClick:function(){return o(t,n.id)},size:22})))},meta:{getCellContext:function(){return{className:"count-step-actions"}},flexWidth:25}})],defaultColumn:Q,users:V}}({cycleCountId:o,productId:null==a?void 0:a.id,tableData:c,validationErrors:v,removeRow:f,isStepEditable:I,formatLocalizedDate:G,addEmptyRow:d,triggerValidation:V,refreshFocusCounter:U}),X=Q.columns,K=Q.defaultColumn,$=Q.users,H=F?{id:F.id,value:F.id,label:null!==(t=F.label)&&void 0!==t?t:"".concat(F.firstName," ").concat(F.lastName),name:"".concat(F.firstName," ").concat(F.lastName)}:void 0,Z=q?{id:q.id,value:q.id,label:null!==(n=q.label)&&void 0!==n?n:"".concat(q.firstName," ").concat(q.lastName),name:"".concat(q.firstName," ").concat(q.lastName)}:void 0,J=function(){return null===Y?null:null==q||!q.id||null};return r.createElement("div",{className:"list-page-list-section"},r.createElement("p",{className:"count-step-title pt-4 pl-4"},null==a?void 0:a.productCode," ",null==a?void 0:a.name),r.createElement("div",{className:"pt-3 pl-4 d-flex align-items-center"},I?r.createElement(C.A,{label:z("react.cycleCount.dateCounted.label","Date counted")},r.createElement(E.A,{className:"date-counted-date-picker date-field-input",onChangeRaw:p,value:i,customDateFormat:A.o.DD_MMM_YYYY})):r.createElement(h.A,{label:z("react.cycleCount.dateCounted.label","Date counted"),value:G(i,A.o.DD_MMM_YYYY)}),I?r.createElement(C.A,{label:z("react.cycleCount.countedBy.label","Counted by"),className:"ml-4"},r.createElement(_.A,{content:(null==Z?void 0:Z.label)||z("react.cycleCount.countedBy.label","Counted By"),show:!J()},r.createElement("div",{className:"position-relative"},r.createElement(w.A,{errorMessage:J(),placeholder:"Select",options:$,onChange:m(o),className:"min-width-250 ".concat(J()&&"input-has-error"),defaultValue:H}),J()&&r.createElement(_.A,{content:z("react.cycleCount.requiredField","This field is required"),className:"tooltip-icon tooltip-icon--error tooltip-icon--top-40",icon:l.sFm})))):r.createElement(h.A,{label:z("react.cycleCount.countedBy.label","Counted by"),value:null==Z?void 0:Z.label,className:"ml-4"})),r.createElement("div",{className:"mx-4 count-step-table"},r.createElement(g.A,{columns:X,data:c,totalCount:c.length,defaultColumn:K,meta:s,filterParams:{},disablePagination:!0})),I&&r.createElement("div",{className:"ml-4 mb-3 d-flex"},r.createElement(b.Tooltip,{className:"d-flex align-items-center",html:r.createElement("span",{className:"p-1"},z("react.cycleCount.addNewRecord.tooltip","Use this button to change lot number or bin location."))},r.createElement(u.A,{onClick:function(){return d(null==a?void 0:a.id,o)},label:"react.cycleCount.addNewRecord.label",defaultLabel:"Add new record",variant:"transparent",StartIcon:r.createElement(RiAddCircleLine,{size:18})}))))};const Y=F;F.propTypes={id:i().string.isRequired,product:i().shape({productCode:i().string.isRequired,name:i().string.isRequired}).isRequired,dateCounted:i().string.isRequired,tableData:i().arrayOf(i().shape({})).isRequired,tableMeta:i().shape({updateData:i().func.isRequired}).isRequired,addEmptyRow:i().func.isRequired,removeRow:i().func.isRequired,assignCountedBy:i().func.isRequired,validationErrors:i().shape({}).isRequired,setCountedDate:i().func.isRequired,isStepEditable:i().bool.isRequired,countedBy:i().shape({id:i().string.isRequired,value:i().string.isRequired,label:i().string.isRequired,name:i().string.isRequired}).isRequired,defaultCountedBy:i().shape({}).isRequired,isFormValid:i().bool.isRequired,refreshFocusCounter:i().number.isRequired,triggerValidation:i().func.isRequired};var U=n(95093),V=n.n(U),z=n(84976),W=n(8949),G=n(15095),Q=n(46857),X=n(76477);const K={REQUESTED:"REQUESTED",COUNTING:"COUNTING",COUNTED:"COUNTED",INVESTIGATING:"INVESTIGATING",READY_TO_REVIEW:"READY_TO_REVIEW",REVIEWED:"REVIEWED",COMPLETED:"COMPLETED",CANCELED:"CANCELED"};var $=n(14476),H=n(88463),Z=n(11209);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return(t=function(e){var t=function(e){if("object"!=J(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==J(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=n(50563),oe=n(77227),ae=n(55216);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function le(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ye(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function ue(){ue=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,i=Object.create(a.prototype),l=new S(r||[]);return o(i,"_invoke",{value:O(e,n,l)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var f="suspendedStart",m="suspendedYield",v="executing",p="completed",y={};function b(){}function h(){}function C(){}var g={};c(g,i,(function(){return this}));var E=Object.getPrototypeOf,w=E&&E(E(T([])));w&&w!==n&&r.call(w,i)&&(g=w);var A=C.prototype=b.prototype=Object.create(g);function N(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(o,a,i,l){var u=d(e[o],e,a);if("throw"!==u.type){var c=u.arg,s=c.value;return s&&"object"==ie(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,i,l)}),(function(e){n("throw",e,i,l)})):t.resolve(s).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,n,r){var o=f;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var l=r.delegate;if(l){var u=x(l,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var c=d(t,n,r);if("normal"===c.type){if(o=r.done?p:m,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=p,r.method="throw",r.arg=c.arg)}}}function x(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=d(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(ie(t)+" is not iterable")}return h.prototype=C,o(A,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:h,configurable:!0}),h.displayName=c(C,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,c(e,u,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},N(I.prototype),c(I.prototype,l,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new I(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},N(A),c(A,u,"Generator"),c(A,i,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function ce(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}function se(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ce(a,r,o,i,l,"next",e)}function l(e){ce(a,r,o,i,l,"throw",e)}i(void 0)}))}}function de(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ye(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return(t=function(e){var t=function(e){if("object"!=ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||ye(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){if(e){if("string"==typeof e)return be(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const he=function(){var e=(0,r.useRef)([]),t=pe((0,r.useState)({}),2),n=t[0],o=t[1],a=pe((0,r.useState)({}),2),i=a[0],l=a[1],u=pe((0,r.useState)({}),2),d=u[0],f=u[1],m=pe((0,r.useState)(!0),2),v=m[0],p=m[1],b=pe((0,r.useState)(0),2),h=b[0],C=b[1],g=pe((0,r.useState)(!1),2),E=g[0],w=g[1],N=(0,y.wA)(),I=(0,z.useHistory)(),x=(0,re.A)(),D=x.show,R=x.hide,S=(0,y.d4)((function(e){return{cycleCountIds:e.cycleCount.requests,currentLocation:e.session.currentLocation}})),T=S.cycleCountIds,j=S.currentLocation,_=function(){C((function(e){return e+1}))},P=(0,r.useMemo)((function(){return(0,k.Wx)(j.supportedActivities)}),[null==j?void 0:j.id]);(0,r.useEffect)((function(){P&&N((0,W.Gg)(null==j?void 0:j.id,[X.A.RECEIVE_STOCK]))}),[null==j?void 0:j.id]);var B=function(e){var t=e.tableData,n=(0,r.useRef)({}),o=(0,r.useRef)(null),a=(0,L.A)(),i=(0,H.A)({tableData:t}),l=i.checkDuplicatedLotNumber,u=i.checkDifferentExpirationDatesForTheSameLot,c=i.checkProductsWithLotAndExpiryControl,s=i.checkLotNumberRequireness,d=(0,Z.A)().forceRerender,f=$.z.object({id:$.z.string(),quantityCounted:$.z.number({required_error:a("react.cycleCount.requiredQuantityCounted","Quantity counted is required"),invalid_type_error:a("react.cycleCount.requiredQuantityCounted","Quantity counted is required")}).gte(0),inventoryItem:$.z.object({expirationDate:$.z.string().optional().nullable(),lotNumber:$.z.string().optional().nullable()}).optional(),binLocation:$.z.object({id:$.z.string(),name:$.z.string(),label:$.z.string().optional()}).optional().nullish()}).refine(s,{path:["inventoryItem.lotNumber"],message:a("react.cycleCount.requiredLotNumber","Lot number is required")}),m=$.z.array(f).superRefine(l).superRefine(u).superRefine(c);return{validationErrors:n.current,isFormValid:o.current,triggerValidation:function(){var e=t.current.reduce((function(e,t){var n,r=m.safeParse(t.cycleCountItems);return te(te({},e),{},ne({},t.id,{errors:null==r||null===(n=r.error)||void 0===n?void 0:n.format(),success:r.success}))}),{}),r=O().every(Object.values(e),(function(e){return e.success}));return n.current=e,o.current=r,r},forceRerender:d,rowValidationSchema:f,rowsValidationSchema:m,resetValidationState:function(){n.current={},o.current=null}}}({tableData:e}),q=B.validationErrors,M=B.triggerValidation,F=B.forceRerender,Y=B.isFormValid,U=B.resetValidationState,J=function(e){var t=O().groupBy(e,"custom"),n=t.false,r=t.true;if(!r)return n;var o=O().sortBy(r,"dateCreated");return[].concat(de(n),de(o))},ee=function(){var t=se(ue().mark((function t(){var n,r,a,i,u,c,s;return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(T.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,D(),t.next=6,G.A.getCycleCounts(null==j?void 0:j.id,T);case 6:i=t.sent,u=i.data,e.current=null===(d=null==u?void 0:u.data,n=d.map((function(e){return me(me({},e),{},{cycleCountItems:e.cycleCountItems.filter((function(e){return 0===e.countIndex}))})})))||void 0===n?void 0:n.map((function(e){return me(me({},e),{},{cycleCountItems:J(null==e?void 0:e.cycleCountItems)})})),c=null==u||null===(r=u.data)||void 0===r?void 0:r.reduce((function(e,t){var n;return me(me({},e),{},ve({},null==t?void 0:t.id,null==t||null===(n=t.cycleCountItems[0])||void 0===n?void 0:n.dateCounted))}),{}),f(c),s=null==u||null===(a=u.data)||void 0===a?void 0:a.reduce((function(e,t){var n;return me(me({},e),{},ve({},null==t?void 0:t.id,null==t||null===(n=t.cycleCountItems[0])||void 0===n?void 0:n.assignee))}),{}),o(s),l(s);case 14:return t.prev=14,R(),t.finish(14);case 17:case"end":return t.stop()}var d}),t,null,[[2,,14,17]])})));return function(){return t.apply(this,arguments)}}();(0,r.useEffect)((function(){ee()}),[T]),(0,r.useEffect)((function(){N((0,W.hU)())}),[]);var ie=function(){var e=se(ue().mark((function e(t){return ue().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(),e.next=3,(0,ae.A)({url:(0,Q.BC)(null==j?void 0:j.id),params:{id:T},format:t});case 3:_(),R();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(t,n){var r=e.current.findIndex((function(e){return(null==e?void 0:e.id)===t}));e.current=e.current.map((function(e,t){return t===r?me(me({},e),{},{cycleCountItems:e.cycleCountItems.map((function(e){return me(me({},e),{},{updated:n})}))}):e}))},fe=function(e){return ce(e,!0)},ye=function(e){return null==n?void 0:n[e]},be=function(t,n){var r=e.current.findIndex((function(e){return(null==e?void 0:e.id)===t}));e.current=e.current.map((function(e,t){return t===r?me(me({},e),{},{cycleCountItems:e.cycleCountItems.filter((function(e){return e.id!==n}))}):e})),_(),M()},he=function(){var e=se(ue().mark((function e(t,n){return ue().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,D(),n.includes("newRow")){e.next=5;break}return e.next=5,G.A.deleteCycleCountItem(null==j?void 0:j.id,n);case 5:be(t,n);case 6:return e.prev=6,R(),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[0,,6,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Ce=function(e){return d[e]},ge=function(e,t){var n,r,o,a;return me(me({},e),{},{recount:!1,assignee:null===(n=ye(t.id))||void 0===n?void 0:n.id,dateCounted:Ce(t.id),inventoryItem:me(me({},null==e?void 0:e.inventoryItem),{},{product:null===(r=e.product)||void 0===r?void 0:r.id,expirationDate:null===(null==e||null===(o=e.inventoryItem)||void 0===o?void 0:o.expirationDate)?null:V()(null==e||null===(a=e.inventoryItem)||void 0===a?void 0:a.expirationDate,A.o.MMM_DD_YYYY).format()})})},Ee=function(){var t=se(ue().mark((function t(){var n,r,o,a,i,l,u,c,s,d,f;return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,D(),U(),n=le(e.current),t.prev=4,n.s();case 6:if((r=n.n()).done){t.next=47;break}o=r.value,a=o.cycleCountItems.filter((function(e){return e.updated&&!e.id.includes("newRow")})),i=le(a),t.prev=10,i.s();case 12:if((l=i.n()).done){t.next=18;break}return u=l.value,t.next=16,G.A.updateCycleCountItem(ge(u,o),null==j?void 0:j.id,null==u?void 0:u.id);case 16:t.next=12;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(10),i.e(t.t0);case 23:return t.prev=23,i.f(),t.finish(23);case 26:c=o.cycleCountItems.filter((function(e){return e.id.includes("newRow")})),s=le(c),t.prev=28,s.s();case 30:if((d=s.n()).done){t.next=36;break}return f=d.value,t.next=34,G.A.createCycleCountItem(ge(f,o),null==j?void 0:j.id,null==o?void 0:o.id);case 34:t.next=30;break;case 36:t.next=41;break;case 38:t.prev=38,t.t1=t.catch(28),s.e(t.t1);case 41:return t.prev=41,s.f(),t.finish(41);case 44:m=o.id,ce(m,!1);case 45:t.next=6;break;case 47:t.next=52;break;case 49:t.prev=49,t.t2=t.catch(4),n.e(t.t2);case 52:return t.prev=52,n.f(),t.finish(52);case 55:return t.prev=55,t.next=58,ee();case 58:return _(),R(),t.finish(55);case 61:case"end":return t.stop()}var m}),t,null,[[0,,55,61],[4,49,52,55],[10,20,23,26],[28,38,41,44]])})));return function(){return t.apply(this,arguments)}}(),we={title:{label:"react.cycleCount.modal.resolveDiscrepanciesTitle.label",default:"Resolve discrepancies?"},content:{label:"react.cycleCount.modal.resolveDiscrepanciesContent.label",default:"There are discrepancies to resolve. Would you like to resolve them?"}},Ae=function(e){return function(t){return[{variant:"transparent",defaultLabel:"Not now",label:"react.cycleCount.modal.notNow.label",onClick:function(){I.push(c.BC.list(s.v0)),null==t||t()}},{variant:"primary",defaultLabel:"Resolve",label:"react.cycleCount.modal.resolve.label",onClick:(n=se(ue().mark((function n(){return ue().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return D(),null==t||t(),n.next=4,N((0,W.$l)(e,null==j?void 0:j.id));case 4:I.push(c.BC.resolveStep()),R();case 6:case"end":return n.stop()}}),n)}))),function(){return n.apply(this,arguments)})}];var n}},Ne=function(e){(0,oe.A)(me(me({buttons:Ae(e)},we),{},{hideCloseButton:!0,closeOnClickOutside:!1}))},Ie=function(){var t=se(ue().mark((function t(){var n,r;return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,D(),t.next=4,Ee();case 4:return t.next=6,Promise.all(e.current.reduce((function(e,t){return[].concat(de(e),[G.A.submitCount({refreshQuantityOnHand:!0,failOnOutdatedQuantity:!1,requireRecountOnDiscrepancy:!0,cycleCountItems:t.cycleCountItems},null==j?void 0:j.id,null==t?void 0:t.id)])}),[]));case 6:if(n=t.sent,r=n.reduce((function(e,t){var n,r=t.data;return r.data.status===(null==K?void 0:K.COUNTED)?[].concat(de(e),[null==r||null===(n=r.data)||void 0===n?void 0:n.requestId]):e}),[]),N((0,W.ob)()),!(r.length>0)){t.next=12;break}return Ne(r),t.abrupt("return");case 12:I.push(c.BC.list(s.Wg));case 13:return t.prev=13,w(!1),_(),R(),t.finish(13);case 18:case"end":return t.stop()}}),t,null,[[0,,13,18]])})));return function(){return t.apply(this,arguments)}}(),Oe={updateData:function(t,n,r,o){!function(t,n,r,o){var a=e.current.findIndex((function(e){return(null==e?void 0:e.id)===t})),i=e.current[a].cycleCountItems.findIndex((function(e){return e.id===n})),l=r.replaceAll("_",".");O().set(e.current,"[".concat(a,"].cycleCountItems[").concat(i,"].").concat(l),o),O().set(e.current,"[".concat(a,"].cycleCountItems[").concat(i,"].updated"),!0)}(t,n,r,o)}};return{tableData:e.current,tableMeta:Oe,validationErrors:q,triggerValidation:M,addEmptyRow:function(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={id:O().uniqueId("newRow"),product:{id:t},inventoryItem:{lotNumber:null,expirationDate:null},binLocation:null,quantityCounted:null,comment:""},a=e.current.findIndex((function(e){return(null==e?void 0:e.id)===n}));e.current=e.current.map((function(e,t){return t===a?me(me({},e),{},{cycleCountItems:[].concat(de(e.cycleCountItems),[o])}):e})),r&&_(),U(),F()},removeRow:he,printCountForm:ie,assignCountedBy:function(e){return function(t){fe(e),o((function(n){return me(me({},n),{},ve({},e,t))})),l((function(n){return me(me({},n),{},ve({},e,t))})),l((function(n){return me(me({},n),{},ve({},e,t))})),_()}},getCountedBy:ye,getDefaultCountedBy:function(e){return null==i?void 0:i[e]},countedBy:n,getCountedDate:Ce,setCountedDate:function(e){return function(t){fe(e),f((function(n){return me(me({},n),{},ve({},e,t.format()))})),_()}},next:function(){var e=M();F();var t=O().every(T,(function(e){var t;return null===(t=ye(e))||void 0===t?void 0:t.id}));e&&t&&p(!1),_()},back:function(){p(!0),_()},save:Ee,resolveDiscrepancies:Ie,isStepEditable:v,isFormValid:Y,refreshFocusCounter:h,isSaveDisabled:E,setIsSaveDisabled:w}};var Ce=n(69641);const ge=function(){var e=he(),t=e.tableData,n=e.printCountForm,a=e.next,i=e.save,l=e.resolveDiscrepancies,u=e.back,c=e.tableMeta,s=e.addEmptyRow,d=e.removeRow,f=e.assignCountedBy,m=e.getCountedDate,v=e.setCountedDate,y=e.validationErrors,b=e.isStepEditable,h=e.getCountedBy,C=e.getDefaultCountedBy,g=e.isFormValid,E=e.triggerValidation,w=e.refreshFocusCounter,A=e.isSaveDisabled,N=e.setIsSaveDisabled;return r.createElement(Ce.A,null,b?r.createElement(p,{printCountForm:n,next:a,save:i}):r.createElement(o.A,{back:u,save:l,isSaveDisabled:A,setIsSaveDisabled:N}),t.map((function(e){var t,n=e.cycleCountItems,o=e.id;return r.createElement(Y,{key:o,id:o,product:null===(t=n[0])||void 0===t?void 0:t.product,dateCounted:m(o),tableData:n,tableMeta:c,addEmptyRow:s,removeRow:d,setCountedDate:v(o),assignCountedBy:f,validationErrors:y,isStepEditable:b,countedBy:h(o),defaultCountedBy:C(o),isFormValid:g,triggerValidation:E,refreshFocusCounter:w})})))}},77227:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(96540),o=n(23350),a=n(5556),i=n.n(a),l=n(42164),u=n(26216),c=function(e){var t,n=e.labels,o=n.title,a=n.content,i=e.onClose,c=e.buttons,s=e.className,d=e.hideCloseButton;return r.createElement("div",{className:"d-flex flex-column custom-modal-content justify-content-between bg-white ".concat(s)},r.createElement("div",{className:"d-flex justify-content-between"},(null==o?void 0:o.label)&&(null==o?void 0:o.default)&&r.createElement("p",{className:"custom-modal-title"},r.createElement(u.A,{id:null==o?void 0:o.label,defaultMessage:null==o?void 0:o.default})),!d&&r.createElement(RiCloseFill,{size:"32px",className:"cursor-pointer",role:"button",onClick:i})),r.createElement("div",null,(null==a?void 0:a.label)&&(null==a?void 0:a.default)&&r.createElement("p",{className:"custom-modal-text"},r.createElement(u.A,{id:null==a?void 0:a.label,defaultMessage:null==a?void 0:a.default}))),r.createElement("div",{className:"d-flex justify-content-end"},null==c||null===(t=c.map)||void 0===t?void 0:t.call(c,(function(e){return r.createElement(l.A,{key:null==e?void 0:e.label,variant:null==e?void 0:e.variant,defaultLabel:null==e?void 0:e.defaultLabel,label:null==e?void 0:e.label,onClick:null==e?void 0:e.onClick})}))))};const s=c;c.propTypes={labels:i().shape({title:i().shape({label:i().string,default:null===i()||void 0===i()?void 0:i().string}),content:i().shape({label:i().string,default:null===i()||void 0===i()?void 0:i().string})}),onClose:i().func.isRequired,className:i().string,buttons:i().arrayOf(i().shape({variant:i().string,defaultLabel:i().string.isRequired,label:i().string.isRequired,onClick:i().func.isRequired})),hideCloseButton:i().bool},c.defaultProps={labels:{title:{label:"",content:""},content:{label:"",content:""}},buttons:[],className:"",hideCloseButton:!1};const d=function(e){var t=e.title,n=e.content,a=e.buttons,i=e.handleOnClose,l=e.hideCloseButton,u=e.closeOnClickOutside,c=void 0===u||u;(0,o.ZX)({customUI:function(e){var o=e.onClose;return r.createElement(s,{labels:{title:t,content:n},onClose:function(){o(),null==i||i()},buttons:a(o),hideCloseButton:l})},closeOnClickOutside:c})}}}]);
//# sourceMappingURL=bundle.929af1b45eb780bfc503.7732.js.map