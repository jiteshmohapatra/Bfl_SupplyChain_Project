"use strict";(self.webpackChunkopenboxes=self.webpackChunkopenboxes||[]).push([[7701],{924:(e,t,n)=>{function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},a.apply(this,arguments)}function r(e,t,n,r){n[r]=a({},e[t],{name:r,change:e[r]&&e[r].change,blur:e[r]&&e[r].blur,focus:e[r]&&e[r].focus,lastFieldState:void 0}),n[r].change||delete n[r].change,n[r].blur||delete n[r].blur,n[r].focus||delete n[r].focus}n.d(t,{A:()=>l});var o=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},i=function(e,t,n){var a=e[0],i=e[1],s=e[2];(0,n.changeValue)(t,a,(function(e){var t=[].concat(e||[]);return t.splice(i,0,s),t}));var l=new RegExp("^"+o(a)+"\\[(\\d+)\\](.*)"),c={};Object.keys(t.fields).forEach((function(e){var n=l.exec(e);if(n){var o=Number(n[1]);if(o>=i){var s=a+"["+(o+1)+"]"+n[2];return void r(t.fields,e,c,s)}}c[e]=t.fields[e]})),t.fields=c},s=function(e,t,n){var a,i=e[0],s=e[1],l=n.changeValue,c=n.getIn,u=n.setIn;l(t,i,(function(e){if(!e)return e;var t=[].concat(e);return a=t[s],t.splice(s,1),t.length>0?t:void 0}));var p=new RegExp("^"+o(i)+"\\[(\\d+)\\](.*)"),f={};return Object.keys(t.fields).forEach((function(e){var n=p.exec(e);if(n){var a=Number(n[1]);if(a===s){if(e===i+"["+s+"]"){var o="formState.submitErrors."+i,l=c(t,o);Array.isArray(l)&&(l.splice(s,1),t=u(t,o,l))}return}if(a>s){var d=i+"["+(a-1)+"]"+n[2];return void r(t.fields,e,f,d)}}f[e]=t.fields[e]})),t.fields=f,a};const l={insert:i,concat:function(e,t,n){var a=e[0],r=e[1];(0,n.changeValue)(t,a,(function(e){return e?[].concat(e,r):r}))},move:function(e,t,n){var a=e[0],i=e[1],s=e[2],l=n.changeValue;if(i!==s){l(t,a,(function(e){var t=[].concat(e||[]),n=t[i];return t.splice(i,1),t.splice(s,0,n),t}));var c,u,p,f={},d=new RegExp("^"+o(a)+"\\[(\\d+)\\](.*)");i>s?(c=s,u=i,p=1):(c=i,u=s,p=-1),Object.keys(t.fields).forEach((function(e){var n=d.exec(e);if(n){var o=Number(n[1]);if(o===i){var l=a+"["+s+"]"+n[2];return void r(t.fields,e,f,l)}if(c<=o&&o<=u){var m=a+"["+(o+p)+"]"+n[2];return void r(t.fields,e,f,m)}}f[e]=t.fields[e]})),t.fields=f}},pop:function(e,t,n){var a=e[0],r=(0,n.getIn)(t.formState.values,a);return r&&r.length>0?s([a,r.length-1],t,n):void 0},push:function(e,t,n){var a=e[0],r=e[1];(0,n.changeValue)(t,a,(function(e){return e?[].concat(e,[r]):[r]}))},remove:s,removeBatch:function(e,t,n){var a=e[0],i=e[1],s=n.changeValue;if(0===i.length)return[];var l=[].concat(i);l.sort();for(var c=l.length-1;c>0;c-=1)l[c]===l[c-1]&&l.splice(c,1);var u=[];s(t,a,(function(e){if(u=i.map((function(t){return e&&e[t]})),!e)return e;for(var t=[].concat(e),n=l.length-1;n>=0;n-=1){var a=l[n];t.splice(a,1)}return t.length>0?t:void 0}));var p=new RegExp("^"+o(a)+"\\[(\\d+)\\](.*)"),f={};return Object.keys(t.fields).forEach((function(e){var n=p.exec(e);if(n){var o=Number(n[1]),i=function(e,t){for(var n=0,a=e.length-1,r=0;n<=a;){if(e[r=Math.floor((n+a)/2)]===t)return r;e[r]>t?a=r-1:n=r+1}return~n}(l,o);if(i>=0)return;if(o>l[0]){var s=a+"["+(o-~i)+"]"+n[2];return void r(t.fields,e,f,s)}}f[e]=t.fields[e]})),t.fields=f,u},shift:function(e,t,n){var a=e[0];return s([a,0],t,n)},swap:function(e,t,n){var a=e[0],o=e[1],i=e[2],s=n.changeValue;if(o!==i){s(t,a,(function(e){var t=[].concat(e||[]),n=t[o];return t[o]=t[i],t[i]=n,t}));var l=a+"["+o+"]",c=a+"["+i+"]",u={};Object.keys(t.fields).forEach((function(e){if(e.substring(0,l.length)===l){var n=e.substring(l.length),a=c+n;r(t.fields,e,u,a)}else if(e.substring(0,c.length)===c){var o=e.substring(c.length),i=l+o;r(t.fields,e,u,i)}else u[e]=t.fields[e]})),t.fields=u}},unshift:function(e,t,n){var a=e[0],r=e[1];return i([a,0,r],t,n)},update:function(e,t,n){var a=e[0],r=e[1],o=e[2];(0,n.changeValue)(t,a,(function(e){var t=[].concat(e||[]);return t.splice(r,1,o),t}))}}},10734:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(96540),r=n(4395),o=n(66792),i=["className"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(null,arguments)}const l=function(e){return a.createElement(r.A,s({},e,{renderInput:function(e){var t=e.className,n=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,i);return a.createElement(o.A,s({name:n.id},n,{className:"select-xs ".concat(t),classNamePrefix:"react-select"}))}}))}},25824:(e,t,n)=>{n.d(t,{A:()=>E});var a=n(96540),r=n(924),o=n(2543),i=n.n(o),s=n(5556),l=n.n(s),c=n(90952),u=n(70373),p=n.n(u),f=n(26438),d=n(26216);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,v(a.key),a)}}function v(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}function O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}var k=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=S(t),function(e,t){if(t&&("object"==m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,O()?Reflect.construct(t,n||[],S(e).constructor):t.apply(e,n))}(this,t,[e])).state={showModal:!1},n.openModal=n.openModal.bind(n),n.closeModal=n.closeModal.bind(n),n.save=n.save.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(t,e),n=t,(o=[{key:"openModal",value:function(){this.props.onOpen(),this.setState({showModal:!0})}},{key:"closeModal",value:function(){this.props.onClose(),this.setState({showModal:!1})}},{key:"save",value:function(e){this.props.onSave(e),this.setState({showModal:!1})}},{key:"render",value:function(){var e=this,t=this.props.title,n=this.props.defaultTitleMessage;return a.createElement("div",{className:this.props.wrapperClassName},this.props.renderButton?this.props.renderButton({openModal:this.openModal}):a.createElement("button",{type:"button",className:"btn-xs ".concat(this.props.btnOpenClassName),style:this.props.btnOpenStyle,disabled:this.props.btnOpenDisabled,onClick:function(){return e.openModal()}},this.props.btnOpenIcon&&a.createElement("i",{className:"fa ".concat(this.props.btnOpenIcon," mr-1"),"aria-hidden":"true"}),this.props.btnOpenText&&!this.props.btnOpenAsIcon&&a.createElement(d.A,{id:this.props.btnOpenText,defaultMessage:this.props.btnOpenDefaultText})),a.createElement(p(),{isOpen:this.props.showModal||this.state.showModal,onRequestClose:this.closeModal,className:"modal-content-custom",shouldCloseOnOverlayClick:!1},a.createElement("div",{className:this.props.bodyContainerClassName,style:this.props.bodyContainerStyle},"string"==typeof t?a.createElement("h5",{className:"text-center"}," ",a.createElement(d.A,{id:t,defaultMessage:n})):a.createElement(t,null),a.createElement("hr",null),a.createElement(c.lV,{onSubmit:function(t){return e.save(t)},initialValues:this.props.initialValues,validate:this.props.validate,mutators:h({},r.A),render:function(t){var n=t.handleSubmit,r=t.values;return a.createElement("form",{id:"modalForm",onSubmit:n},e.props.children,e.props.renderBodyWithValues(r),i().map(e.props.fields,(function(t,n){return(0,f.bl)(t,n,h(h({},e.props.formProps),{},{values:r}))})),a.createElement("hr",null),a.createElement("div",{className:e.props.btnContainerClassName,role:"group",style:e.props.btnContainerStyle},a.createElement("button",{type:"button",className:e.props.btnCancelClassName,style:e.props.btnCancelStyle,onClick:function(){return e.closeModal()}},a.createElement(d.A,{id:e.props.btnCancelText,defaultMessage:e.props.btnCancelDefaultText})),a.createElement("button",{type:"submit",className:e.props.btnSaveClassName,style:e.props.btnSaveStyle,disabled:e.props.btnSaveDisabled},a.createElement(d.A,{id:e.props.btnSaveText,defaultMessage:e.props.btnSaveDefaultText}))))}}))))}}])&&g(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(a.Component);const E=k;k.propTypes={btnOpenText:l().string,btnOpenDefaultText:l().string,btnOpenClassName:l().string,btnOpenStyle:l().shape({}),btnOpenDisabled:l().bool,btnOpenAsIcon:l().bool,btnOpenIcon:l().string,title:l().oneOfType([l().string,l().func]).isRequired,defaultTitleMessage:l().string.isRequired,children:l().element,bodyContainerClassName:l().string,bodyContainerStyle:l().shape({}),btnContainerClassName:l().string,btnContainerStyle:l().shape({}),renderButton:l().func,wrapperClassName:l().string,btnSaveText:l().string,btnSaveDefaultText:l().string,btnSaveClassName:l().string,btnSaveStyle:l().shape({}),btnSaveDisabled:l().bool,btnCancelText:l().string,btnCancelDefaultText:l().string,btnCancelClassName:l().string,btnCancelStyle:l().shape({}),onOpen:l().func,onSave:l().func,onClose:l().func,validate:l().func,renderBodyWithValues:l().func,initialValues:l().oneOfType([l().shape({}),l().arrayOf(l().shape({}))]),fields:l().shape({}),formProps:l().shape({}),showModal:l().bool},k.defaultProps={btnOpenText:"react.default.button.open.label",btnOpenDefaultText:"Open",btnOpenClassName:"btn btn-outline-primary",btnOpenStyle:{},btnOpenDisabled:!1,btnOpenAsIcon:!1,btnOpenIcon:"",children:null,bodyContainerClassName:"modal-body-container",bodyContainerStyle:{},btnContainerClassName:"btn-group float-right",btnContainerStyle:{},wrapperClassName:null,btnSaveText:"react.default.button.save.label",btnSaveDefaultText:"Save",btnSaveClassName:"btn btn-outline-success",btnSaveStyle:{},btnSaveDisabled:!1,btnCancelText:"react.default.button.cancel.label",btnCancelDefaultText:"Cancel",btnCancelClassName:"btn btn-outline-secondary",btnCancelStyle:{},renderButton:void 0,onOpen:function(){return null},onSave:function(){return null},onClose:function(){return null},validate:function(){return null},renderBodyWithValues:function(){return null},initialValues:[],fields:{},formProps:{},showModal:!1}},29404:(e,t,n)=>{n.d(t,{A:()=>f});var a=n(96540),r=n(4395),o=n(5556),i=n.n(o),s=["onChange","className","fieldRef","isResizable"];function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(null,arguments)}var c=function(e){var t=e.onChange,n=e.className,r=void 0===n?"":n,o=e.fieldRef,i=e.isResizable,c=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,s);return a.createElement("textarea",l({ref:o,onKeyPress:function(e){13===e.which&&e.preventDefault()},className:"form-control form-control-xs ".concat(r," resizable-").concat(i)},c,{onChange:function(e){var n=e.target.value;t&&t(n)}}))};const u=c;function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(null,arguments)}c.propTypes={onChange:i().func,className:i().string,fieldRef:i().func,isResizable:i().bool},c.defaultProps={isResizable:!0,onChange:null,className:"",fieldRef:null};const f=function(e){return a.createElement(r.A,p({},e,{renderInput:function(e){return a.createElement(u,e)}}))}},34297:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(96540),r=n(4395),o=n(40910),i=["inputClassName","className"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(null,arguments)}const l=function(e){return a.createElement(r.A,s({},e,{renderInput:function(e){var t=e.inputClassName,n=e.className,r=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,i);return a.createElement(o.A,s({isFormElement:!0,className:t||n},r))}}))}},57701:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var a=n(96540),r=n(46894),o=n.n(r),i=n(2543),s=n.n(i),l=n(5556),c=n.n(l),u=n(88600),p=n(697),f=n(84914),d=n.n(f),m=n(32885),b=n.n(m),h=n(51836),y=n(8949),g=n(84615),v=n(25824),O=n(10734),S=n(29404),w=n(34297),k=n(43256),E=n(26216);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,N(a.key),a)}}function N(e){var t=function(e){if("object"!=P(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(t)?t:t+""}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(I=function(){return!!e})()}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}var D={recipients:{type:O.A,label:"react.stockListManagement.recipients.label",defaultMessage:"Recipients",attributes:{required:!0,showValueTooltip:!0,multi:!0,className:"multi-select",style:{paddingBottom:5},valueKey:"id",labelKey:"name"},getDynamicAttr:function(e){return{options:e.users}}},subject:{type:w.A,label:"react.stockListManagement.subject.label",defaultMessage:"Subject",attributes:{required:!0}},text:{type:S.A,label:"react.stockListManagement.message.label",defaultMessage:"Message",attributes:{rows:8,required:!0}},includePdf:{type:g.A,label:"react.stockListManagement.includePdf.label",defaultMessage:"Include PDF document"},includeXls:{type:g.A,label:"react.stockListManagement.includeXls.label",defaultMessage:"Include XLS document"}};function L(e){var t={};return s().isEmpty(e.recipients)&&(t.recipients="react.default.error.requiredField.label"),e.subject||(t.subject="react.default.error.requiredField.label"),e.text||(t.text="react.default.error.requiredField.label"),t}var R=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=T(t),function(e,t){if(t&&("object"==P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,I()?Reflect.construct(t,n||[],T(e).constructor):t.apply(e,n))}(this,t,[e])).state={formValues:{},showModal:!1},n.onOpen=n.onOpen.bind(n),n.onSave=n.onSave.bind(n),n.onClose=n.onClose.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(t,e),n=t,(r=[{key:"onOpen",value:function(){var e=this.props.manager;this.setState({formValues:{subject:this.props.translate("react.stockListManagement.emailSubject.label","STOCK LIST UPDATE"),text:this.props.translate("react.stockListManagement.emailMessage.label","Please find attached a new version of your stock list reflecting recent updates. Please use this version for your next replenishment request."),recipients:e?[{id:e.id,email:e.email,label:e.name}]:[],includePdf:!0,includeXls:!0,showModal:!0}})}},{key:"onSave",value:function(e){var t=this;this.props.showSpinner();var n="/api/stocklists/sendMail/".concat(this.props.stocklistId,"?includePdf=").concat(this.state.formValues.includePdf,"?includeXls=").concat(this.state.formValues.includeXls),a=j(j({},e),{},{recipients:s().map(s().filter(e.recipients,(function(e){return e.email})),(function(e){return e.email}))}),r=this.props.manager;s().some(e.recipients,(function(e){return e.email===r.email}))?k.Ay.post(n,a).then((function(){t.props.hideSpinner(),t.setState({showModal:!1}),d().success(t.props.translate("react.stockListManagement.alert.emailSend.label","Email sent successfully"),{timeout:1e3})})).catch((function(){return t.props.hideSpinner()})):(this.props.hideSpinner(),d().error(this.props.translate("react.stockListManagement.alert.noManagerSelected.label","Please add a manager as a recipient and resend."),{timeout:1e3}),this.setState({showModal:!0}))}},{key:"onClose",value:function(){this.setState({showModal:!1})}},{key:"render",value:function(){return a.createElement(v.A,{title:"react.stockListManagement.sendMailModalTitle.label",btnOpenText:"react.default.button.email.label",btnOpenDefaultText:"Email",btnSaveText:"react.default.button.send.label",btnSaveDefaultText:"Send",btnOpenClassName:"btn btn-outline-secondary btn-xs mr-1",onOpen:this.onOpen,onSave:this.onSave,onClose:this.onClose,fields:D,initialValues:this.state.formValues,formProps:{users:this.props.users},validate:L,showModal:this.state.showModal})}}])&&C(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(a.Component);const F=(0,p.Ng)((function(e){return{translate:(0,E.H)((0,u.ro)(e.localize))}}),{showSpinner:y.xc,hideSpinner:y.W$})(R);R.propTypes={showSpinner:c().func.isRequired,hideSpinner:c().func.isRequired,stocklistId:c().string.isRequired,users:c().arrayOf(c().shape({})),manager:c().shape({}),translate:c().func.isRequired},R.defaultProps={users:[],manager:null};var _=n(50709),V=n(40910),q=n(66792);function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){X(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,z(a.key),a)}}function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H=function(){return!!e})()}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W(e,t)}function X(e,t,n){return(t=z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}var K=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),X(n=function(e,t,n){return t=$(t),function(e,t){if(t&&("object"==Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,H()?Reflect.construct(t,n||[],$(e).constructor):t.apply(e,n))}(this,t,[e]),"dataFetched",!1),n.state={data:[],selectedStocklist:null,availableStocklists:[],productInfo:null,users:[],isDataLoading:!0,usersFetched:!1,stocklistsFetched:!1},n.addItem=n.addItem.bind(n),n.editItem=n.editItem.bind(n),n.updateItemField=n.updateItemField.bind(n),n.saveItem=n.saveItem.bind(n),n.deleteItem=n.deleteItem.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this.props.fetchTranslations("","stockListManagement"),this.props.stockListManagementTranslationsFetched&&(this.dataFetched=!0,this.fetchData(),this.fetchAvailableStocklists(),this.fetchProductInfo(),this.fetchUsers())}},{key:"componentWillReceiveProps",value:function(e){this.props.locale&&this.props.locale!==e.locale&&this.props.fetchTranslations(e.locale,"stockListManagement"),e.stockListManagementTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchData(),this.fetchAvailableStocklists(),this.fetchProductInfo(),this.fetchUsers())}},{key:"componentDidUpdate",value:function(e,t){t.usersFetched&&t.stocklistsFetched||!this.state.usersFetched||!this.state.stocklistsFetched||this.props.hideSpinner()}},{key:"fetchUsers",value:function(){var e=this;this.props.showSpinner(),k.Ay.get("/api/persons",{params:{status:!0}}).then((function(t){e.setState({users:t.data.data,usersFetched:!0})})).catch((function(){return e.props.hideSpinner()}))}},{key:"fetchData",value:function(){var e=this;this.props.showSpinner();var t="/api/stocklistItems?product.id=".concat(this.props.match.params.productId||"");k.Ay.get(t).then((function(t){e.setState({data:(0,k.xp)(t.data.data),isDataLoading:!1})})).catch(this.props.hideSpinner())}},{key:"fetchAvailableStocklists",value:function(){var e=this;this.props.showSpinner(),k.Ay.get("/api/stocklistItems/availableStocklists").then((function(t){e.setState({availableStocklists:(0,k.xp)(t.data.data),stocklistsFetched:!0})})).catch(this.props.hideSpinner())}},{key:"fetchProductInfo",value:function(){var e=this;this.props.showSpinner();var t="/api/products/".concat(this.props.match.params.productId,"/withCatalogs");k.Ay.get(t).then((function(t){e.setState({productInfo:t.data.data})})).catch(this.props.hideSpinner())}},{key:"addItem",value:function(e){this.setState((function(t){return{selectedStocklist:null,data:o()(t.data,{$push:[{stocklistId:e.id,name:e.name,location:{id:e.location.id,name:e.location.name},locationGroup:{id:e.locationGroup.id,name:e.locationGroup.name},manager:{id:e.manager.id,name:e.manager.name},replenishmentPeriod:e.replenishmentPeriod,maxQuantity:null,new:!0}]})}}))}},{key:"editItem",value:function(e){this.setState((function(t){return{data:o()(t.data,X({},e,{edit:{$set:!0}}))}}))}},{key:"updateItemField",value:function(e,t,n){this.setState((function(a){return{data:o()(a.data,X({},e,X({},t,{$set:n})))}}))}},{key:"saveItem",value:function(e,t){var n=this,a="/api/stocklistItems?product.id=".concat(this.props.match.params.productId||"");t.new||(a="/api/stocklistItems/".concat(t.id)),k.Ay.post(a,(0,k.iR)(t)).then((function(t){n.setState((function(n){return{data:o()(n.data,X({},e,{$set:(0,k.xp)(t.data.data)}))}}))})).catch(this.props.hideSpinner())}},{key:"deleteItem",value:function(e){var t=this,n=this.state.data[e];if(n.new)this.removeItem(e);else{this.props.showSpinner();var a="/api/stocklistItems/".concat(n.id);k.Ay.delete(a).then((function(){t.removeItem(e)})).catch(this.props.hideSpinner())}}},{key:"removeItem",value:function(e){this.setState((function(t){return{data:o()(t.data,{$splice:[[e,1]]})}}))}},{key:"render",value:function(){var e=this,t=this.state.data;return a.createElement("div",{className:"main-container"},this.state.productInfo&&a.createElement("div",{className:"mb-2"},a.createElement("div",{className:"d-flex flex-row justify-content-between"},a.createElement("div",{className:"d-flex flex-row align-items-end"},a.createElement("h6",{className:"mb-0 mr-1"},this.state.productInfo.productCode),a.createElement("h5",{className:"mb-0"},this.state.productInfo.name)),a.createElement("div",{className:"align-self-center"},a.createElement("button",{type:"button",className:"btn btn-outline-primary btn-xs",onClick:function(){window.location=_.v1.showStockCard(e.state.productInfo.id)}},a.createElement(E.A,{id:"react.stockListManagement.returnStockCard.label",defaultMessage:"Return to stock card"})))),a.createElement("div",{className:"d-flex flex-row"},s().map(this.state.productInfo.catalogs,(function(e){return a.createElement("div",{key:e.id,className:"stocklist-category px-1 mr-1"},e.name)})))),a.createElement(b(),{data:t,pivotBy:["locationGroup.name","location.name"],showPagination:!1,minRows:0,sortable:!1,noDataText:this.state.isDataLoading?"Loading...":"No rows found",style:{maxHeight:this.state.productInfo&&s().some(this.state.productInfo.catalogs,(function(e){return!s().isEmpty(e)}))?"calc(100vh - 275px)":"calc(100vh - 250px)"},collapseOnDataChange:!1,defaultSorted:[{id:"locationGroup.name"}],resolveData:function(e){return e.map((function(e){return s().get(e,"locationGroup.name")?e:U(U({},e),{},{locationGroup:{name:"No location group"}})}))},columns:[{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.locationGroup.label","Location Group Name"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.locationGroup.label",defaultMessage:"Location Group Name"})),accessor:"locationGroup.name",className:"w-space-normal"},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.locationName.label","Location Name"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.locationName.label",defaultMessage:"Location Name"})),accessor:"location.name",aggregate:function(){return""},className:"w-space-normal"},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.stockListName.label","Stocklist Name"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.stockListName.label",defaultMessage:"Stocklist Name"})),accessor:"name",aggregate:function(){return""},Cell:function(e){var t=e.aggregated,n=e.original;return t?"":a.createElement("a",{href:_.WC.show(n.stocklistId)},a.createElement(h.Tooltip,{title:n.name,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},n.name))}},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.monthlyStockListQty.label","Monthly Stocklist Qty"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.monthlyStockListQty.label",defaultMessage:"Monthly Stocklist Qty"})),accessor:"monthlyDemand",aggregate:function(e){return s().sum(e)},className:"text-center",Cell:function(e){var t=e.aggregated,n=e.original;return t?"":a.createElement(h.Tooltip,{title:n.monthlyDemand,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},n.monthlyDemand)}},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.manager.label","Manager"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.manager.label",defaultMessage:"Manager"})),accessor:"manager.name",aggregate:function(){return""},Cell:function(e){var t=e.aggregated,n=e.original;return t?"":a.createElement(h.Tooltip,{title:n.manager.name,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},n.manager.name)}},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.replenishmentPeriod.label","Replenishment period"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.replenishmentPeriod.label",defaultMessage:"Replenishment period"})),accessor:"replenishmentPeriod",aggregate:function(){return""},className:"text-center",Cell:function(e){var t=e.aggregated,n=e.original;return t?"":a.createElement(h.Tooltip,{title:n.replenishmentPeriod,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},n.replenishmentPeriod)}},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.replenishmentQty.label","Replenishment Qty"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.replenishmentQty.label",defaultMessage:"Replenishment Qty"})),accessor:"maxQuantity",aggregate:function(e){return s().sum(e)},className:"text-center",Cell:function(t){var n=t.aggregated,r=t.index,o=t.original;return n?"":o.new||o.edit?a.createElement("div",{className:s().isNil(o.maxQuantity)||""===o.maxQuantity?"has-error":""},a.createElement(h.Tooltip,{title:o.maxQuantity,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(V.A,{value:o.maxQuantity||"",onChange:function(t){return e.updateItemField(r,"maxQuantity",t)}}))):s().isNil(o.maxQuantity)?"":o.maxQuantity}},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.uom.label","Unit of measure"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.uom.label",defaultMessage:"Unit of measure"})),accessor:"uom",aggregate:function(){return""},className:"text-center",Cell:function(e){var t=e.aggregated,n=e.original;return t?"":a.createElement(h.Tooltip,{title:n.uom,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},n.uom)}},{Header:a.createElement(h.Tooltip,{title:this.props.translate("react.stockListManagement.actions.label","Actions"),theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement(E.A,{id:"react.stockListManagement.actions.label",defaultMessage:"Actions"})),accessor:"edit",minWidth:230,className:"text-center",aggregate:function(){return""},Cell:function(t){var n=t.aggregated,r=t.index,o=t.original;return n?"":a.createElement("div",{className:"d-flex flex-wrap"},e.props.isUserAdmin?a.createElement("div",null,a.createElement("button",{type:"button",className:"btn btn-outline-primary btn-xs mr-1",disabled:o.edit||o.new||!e.props.isUserAdmin,onClick:function(){return e.editItem(r)}},a.createElement(E.A,{id:"react.default.button.edit.label",defaultMessage:"Edit"})),a.createElement("button",{type:"button",className:"btn btn-outline-primary btn-xs mr-1",disabled:!o.edit&&!o.new||!o.stocklistId||s().isNil(o.maxQuantity)||""===o.maxQuantity||!e.props.isUserAdmin,onClick:function(){return e.saveItem(r,o)}},a.createElement(E.A,{id:"react.default.button.save.label",defaultMessage:"Save"})),a.createElement("button",{type:"button",className:"btn btn-outline-danger btn-xs mr-1",disabled:!e.props.isUserAdmin,onClick:function(){return e.deleteItem(r)}},a.createElement(E.A,{id:"react.default.button.delete.label",defaultMessage:"Delete"}))):null,a.createElement("a",{className:"btn btn-outline-secondary btn-xs mr-1",disabled:o.edit||o.new,href:_.Dk.pdf(o.stocklistId)},a.createElement(E.A,{id:"react.default.button.printPdf.label",defaultMessage:"Print PDF"})),a.createElement("a",{className:"btn btn-outline-secondary btn-xs mr-1",disabled:o.edit||o.new,href:_.Dk.csv(o.stocklistId)},a.createElement(E.A,{id:"react.default.button.printXls.label",defaultMessage:"Print XLS"})),o.manager?a.createElement(F,{stocklistId:o.stocklistId,users:e.state.users,manager:o.manager}):a.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-xs mr-1",onClick:function(){return d().error(e.props.translate("react.stockListManagement.alert.noManagerAssociated.label","There is no manager associated with this stock list. Please add a manager and try again."))}},a.createElement(E.A,{id:"react.default.button.email.label",defaultMessage:"Email"})))}}]}),this.props.isUserAdmin?a.createElement("div",{className:"d-flex flex-row my-1"},a.createElement(q.A,{value:this.state.selectedStocklist,onChange:function(t){return e.setState({selectedStocklist:t})},options:this.state.availableStocklists,valueKey:"id",labelKey:"name",className:"select-xs stocklist-select"}),a.createElement("button",{type:"button",className:"btn btn-outline-success btn-xs ml-1",disabled:!this.state.selectedStocklist,onClick:function(){e.addItem(e.state.selectedStocklist)}},a.createElement(E.A,{id:"react.stockListManagement.addStockList.label",defaultMessage:"Add stocklist"}))):null)}}])&&G(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(a.Component);const J=(0,p.Ng)((function(e){return{translate:(0,E.H)((0,u.ro)(e.localize)),locale:e.session.activeLanguage,stockListManagementTranslationsFetched:e.session.fetchedTranslations.stockListManagement,isUserAdmin:e.session.isUserAdmin}}),{showSpinner:y.xc,hideSpinner:y.W$,fetchTranslations:y.dj})(K);K.propTypes={match:c().shape({params:c().shape({productId:c().string})}).isRequired,showSpinner:c().func.isRequired,hideSpinner:c().func.isRequired,translate:c().func.isRequired,locale:c().string.isRequired,stockListManagementTranslationsFetched:c().bool.isRequired,fetchTranslations:c().func.isRequired,isUserAdmin:c().bool.isRequired}},84079:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(96540),r=n(5556),o=n.n(r),i=n(26216),s=["value","indeterminate","custom","fieldRef","withLabel","label","defaultMessage"];function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(null,arguments)}var c=function(e){var t=e.value,n=e.indeterminate,r=e.custom,o=e.fieldRef,c=e.withLabel,u=e.label,p=e.defaultMessage,f=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,s),d=function(e){var t=e.target.checked;f.onChange&&f.onChange(t)};return r?a.createElement("div",{"data-testid":"custom-checkbox",className:"custom-checkbox"},a.createElement("label",{htmlFor:f.id},a.createElement("input",l({id:f.id,type:"checkbox",ref:o,checked:t},f,{onChange:d})))):c?a.createElement("div",{"data-testid":"with-label-checkbox",className:"d-flex align-items-center"},a.createElement("input",l({type:"checkbox",ref:function(e){e&&(e.indeterminate=n),o&&o(e)},checked:t},f,{onChange:d})),a.createElement("label",{htmlFor:f.id,style:{margin:"0 0 0 5px"}},a.createElement(i.A,{id:u,defaultMessage:p||u}))):a.createElement("input",l({"data-testid":"checkbox",type:"checkbox",ref:function(e){e&&(e.indeterminate=n),o&&o(e)},checked:t},f,{onChange:d}))};const u=c;c.propTypes={onChange:o().func,value:o().bool,indeterminate:o().bool,custom:o().bool,id:o().string,fieldRef:o().func,withLabel:o().bool,label:o().string,defaultMessage:o().string},c.defaultProps={onChange:null,value:null,indeterminate:!1,custom:!1,id:"",fieldRef:void 0,withLabel:!1,label:"",defaultMessage:""}},84615:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(96540),r=n(4395),o=n(84079),i=["value"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(null,arguments)}const l=function(e){return a.createElement(r.A,s({},e,{renderInput:function(e){var t=e.value,n=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,i);return a.createElement(o.A,s({},n,{value:t||!1}))}}))}}}]);
//# sourceMappingURL=bundle.929af1b45eb780bfc503.7701.js.map