"use strict";(self.webpackChunkopenboxes=self.webpackChunkopenboxes||[]).push([[990],{80990:(e,t,r)=>{r.r(t),r.d(t,{default:()=>je});var n=r(96540),a=r(2543),i=r.n(a),o=r(5556),l=r.n(o),s=r(4704),c=r(697),u=r(8817),d=r(8949),p=r(43256);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function E(e,t,r){return(t=w(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var S=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),E(r=function(e,t,r){return t=y(t),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,b()?Reflect.construct(t,r||[],y(e).constructor):t.apply(e,r))}(this,t,[e]),"getCategoryRows",(function(e){p.Ay.get(e).then((function(e){var t=e.data.data||[];t=t.filter((function(e){return!r.state.listFilterSelected.some((function(t){return t.id===e.id}))})),r.setState({listCategoryData:t,listCategoryDataFiltered:t})})).catch((function(){return r.setState({listCategoryData:[],listCategoryDataFiltered:[]})}))})),E(r,"searchOnChange",(function(e){var t=r.state.listCategoryData.filter((function(t){return t.name.toLowerCase().includes(e.target.value.toLowerCase())}));r.setState({listCategoryDataFiltered:t,searchTerm:e.target.value})})),E(r,"toggleAddingFilter",(function(){r.setState((function(e){return{addingFilter:!e.addingFilter}}))})),E(r,"toggleCategorySelected",(function(e,t){t&&r.getCategoryRows(t.endpoint),r.setState((function(t){return{titlePopup:e||"Add Filter",categorySelected:e||"",searchTerm:"",filterCategorySelected:!t.filterCategorySelected}}))})),E(r,"loadStoredFilters",(function(){var e=r.props,t=e.pageFilters,n=e.activeConfig;if(t.length>0){var a=[],i=JSON.parse(sessionStorage.getItem("pageConfig"));i||(i={},sessionStorage.setItem("pageConfig",JSON.stringify(i))),i[n]||(i[n]={}),sessionStorage.setItem("pageConfig",JSON.stringify(i)),t.forEach((function(e){(JSON.parse(sessionStorage.getItem("pageConfig"))[r.props.activeConfig][e.name]||[]).forEach((function(e){a.push(e)}))})),r.setState({listFilterSelected:a,filterAvailable:!0})}else r.setState({filterAvailable:!1})})),E(r,"addFilterToTheList",(function(e,t){var n=r.props.activeConfig;r.state.listFilterSelected.push({id:t.id,name:t.name,nameCategory:e}),sessionStorage.getItem("pageConfig")||sessionStorage.setItem("pageConfig",JSON.stringify({}));var a=JSON.parse(sessionStorage.getItem("pageConfig"));a[n][e]||(a[n][e]=[]),a[n][e].push({id:t.id,name:t.name,nameCategory:e}),sessionStorage.setItem("pageConfig",JSON.stringify(a)),r.toggleAddingFilter(),r.toggleCategorySelected(),r.props.fetchData(n)})),E(r,"removeFilterFromList",(function(e){var t=r.props.activeConfig,n=r.state.listFilterSelected,a=n[e],i=JSON.parse(sessionStorage.getItem("pageConfig")),o=a.nameCategory,l=a.id;i[t][o]=i[t][o].filter((function(e){return e.id!==l})),sessionStorage.setItem("pageConfig",JSON.stringify(i));var s=n.slice(0,e).concat(n.slice(e+1,n.length));r.setState({listFilterSelected:s});var c=JSON.parse(sessionStorage.getItem("pageConfig"));0===c[t][a.nameCategory].length&&(delete c[t][a.nameCategory],sessionStorage.setItem("pageConfig",JSON.stringify(c))),r.props.fetchData(t)})),r.state={addingFilter:!1,filterCategorySelected:!1,filterAvailable:!1,listFilterSelected:[],listCategoryData:[],listCategoryDataFiltered:[],titlePopup:"Add filter",searchTerm:"",categorySelected:""},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),r=t,(a=[{key:"componentDidMount",value:function(){this.loadStoredFilters()}},{key:"componentDidUpdate",value:function(e){e.pageFilters===this.props.pageFilters&&e.activeConfig===this.props.activeConfig||this.loadStoredFilters()}},{key:"render",value:function(){var e=this;return this.state.filterAvailable?n.createElement("div",{className:"category-filter"},this.state.listFilterSelected.map((function(t,r){return t&&n.createElement("div",{key:"".concat(t.id," - ").concat(t.name),className:"category-item"},n.createElement("div",{className:"category-title"}," ",t.name),n.createElement("div",{className:"delete-button",role:"button",tabIndex:0,onClick:function(){return e.removeFilterFromList(r)},onKeyPress:function(){return e.removeFilterFromList(r)}}," ","x"))})),n.createElement("div",{className:"category-item add-category-btn",role:"button",tabIndex:0,onClick:this.toggleAddingFilter,onKeyPress:this.toggleAddingFilter,hidden:this.state.addingFilter},"+ Add filter"),n.createElement("div",{className:"add-category-popup",hidden:!this.state.addingFilter},n.createElement("div",null,n.createElement("span",{role:"button",tabIndex:0,onClick:function(){return e.toggleCategorySelected()},onKeyPress:function(){return e.toggleCategorySelected()},hidden:!this.state.filterCategorySelected}," ","<")," ",this.state.titlePopup,n.createElement("span",{role:"button",tabIndex:0,onClick:function(){e.toggleAddingFilter(),e.setState({filterCategorySelected:!1})},onKeyPress:function(){e.toggleAddingFilter(),e.setState({filterCategorySelected:!1})}}," ","X")),n.createElement("input",{type:"text",placeholder:"search...",onChange:this.searchOnChange,hidden:!this.state.filterCategorySelected,value:this.state.searchTerm}),n.createElement("ul",{className:"filter-menu ".concat(this.state.filterCategorySelected?"scrollable":"")},this.state.filterCategorySelected?this.props.pageFilters.map((function(t){return t.name===e.state.categorySelected?Object.entries(e.state.listCategoryDataFiltered.sort((function(e,t){return e.name.localeCompare(t.name)}))).map((function(t){return n.createElement("li",{key:t[1].id},n.createElement("span",{className:"category-value-to-select",role:"button",tabIndex:0,onClick:function(){return e.addFilterToTheList(e.state.categorySelected,t[1])},onKeyPress:function(){return e.addFilterToTheList(e.state.categorySelected,t[1])}},t[1].name))})):null})):Object.entries(this.props.configs).map((function(t){var r=m(t,2),a=r[0],i=r[1];return a===e.props.activeConfig?i.filters&&Object.entries(i.filters).map((function(t){var r=m(t,2),a=r[0],i=r[1];return n.createElement("li",{key:i.endpoint},n.createElement("div",{role:"button",tabIndex:0,onClick:function(){return e.toggleCategorySelected(a,i)},onKeyPress:function(){return e.toggleCategorySelected(a,i)}},a,n.createElement("span",null," ",">")))})):null}))))):null}}])&&g(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(n.Component);const C=S;S.propTypes={configs:l().shape({}).isRequired,activeConfig:l().string.isRequired,fetchData:l().func.isRequired,pageFilters:l().arrayOf(l().shape({name:l().string.isRequired,endpoint:l().string.isRequired}).isRequired).isRequired};var N=r(88600),I=r(51836);const O=(0,u.ni)((function(){return n.createElement("span",{className:"drag-handler"},n.createElement("i",{className:"fa fa-ellipsis-v"}))}));var R=r(91436),D=r.n(R),T=r(16238);const q=function(){return n.createElement("div",{className:"loader-div"},n.createElement(D(),{type:"bubbles",color:(0,T.NP)(),height:"150px",width:"150px"}))};function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k.apply(null,arguments)}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var j=function(e){var t=F(Object.values(e),2),r=t[0],a=t[1],o=i().sortBy(Object.entries(r),"[1].order");return n.createElement("div",{className:"gyr-indicator"},o.map((function(e){var t=F(e,2),r=t[0],i=t[1];if(i){var o=i.link,l=i.value,s=i.subtitle,c=o?{href:o}:{};return n.createElement("a",k({key:r,className:"number-indicator"},c),n.createElement("div",{className:"value"},n.createElement("div",{className:"circle",style:{backgroundColor:a.colors[r]}}),l),n.createElement("div",{className:"subtitle"},s))}return null})))};j.propTypes={data:l().shape({third:l().shape({subtitle:l().string,value:l().number,link:l().string}),second:l().shape({subtitle:l().string,value:l().number,link:l().string}),first:l().shape({subtitle:l().string,value:l().number,link:l().string})}),options:l().shape({colors:l().shape({first:l().string,second:l().string,third:l().string})}).isRequired},j.defaultProps={data:null};const A=j;var L=function(e){var t=e.data;return n.createElement("div",{className:"big-gyr-indicator"},t.listColorNumber.map((function(e,t){return n.createElement("a",{className:"number-indicator",href:e.link,key:t},n.createElement("div",{className:"value",style:{color:(0,T.Er)(e.color,"default")}},n.createElement("span",{className:"circle",style:{background:(0,T.Er)(e.color,"light")}}),e.value),n.createElement("div",{className:"subtitle"},e.subtitle))})))};L.propTypes={data:l().shape({listColorNumber:l().arrayOf(l().shape({link:l().string,color:l().string,subtitle:l().string,value:l().string}))}).isRequired};const x=L;var z=function(e){var t=e.columnsSize,r=e.truncationLength,a=e.disableTruncation,i=e.data,o=function(e){var t=e.truncate,a=e.item,i=e.link,o=e.defaultTruncationLength;return n.createElement("a",{href:i,className:i?"indicator-item-href":"disabled-indicator-item-href",rel:"noreferrer",target:"_blank"},t?_.truncate(a,{length:null!=r?r:o}):a)};return n.createElement("div",{className:"table-card"},n.createElement("table",null,n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{style:{width:null==t?void 0:t.number}},i.number),i.body.find((function(e){return e.icon}))?n.createElement("td",null):null,n.createElement("th",{style:{width:null==t?void 0:t.name},className:"mid"},_.truncate(i.name,{length:50})),n.createElement("th",{style:{width:null==t?void 0:t.value}},_.truncate(i.value,{length:50})))),n.createElement("tbody",null,i.body.map((function(e){return n.createElement("tr",{onClick:function(){e.link&&window.open(e.link,"_blank")},key:"item-".concat(e.number),className:e.link?"table-link":""},n.createElement("td",{style:{width:null==t?void 0:t.number}},o({truncate:null==a?void 0:a.number,item:e.number,link:null==e?void 0:e.numberLink,defaultTruncationLength:80})),e.icon?n.createElement("td",null,n.createElement("img",{alt:"",src:e.icon,width:"20",height:"20"})):null,n.createElement("td",{className:"mid",style:{width:null==t?void 0:t.name}},e.name?o({truncate:null==a?void 0:a.name,item:e.name,link:null==e?void 0:e.nameLink,defaultTruncationLength:80}):(r=e.nameDataList,i=e.nameLinksList,null==r?void 0:r.map((function(e,t){return n.createElement("a",{href:i[t],className:"indicator-item-href",rel:"noreferrer",target:"_blank"},e," ")})))),n.createElement("td",{className:"last",style:{width:null==t?void 0:t.value}},o({truncate:null==a?void 0:a.value,item:e.value,link:null==e?void 0:e.valueLink,defaultTruncationLength:10})));var r,i})))))};z.propTypes={data:l().shape({number:l().string,name:l().string,value:l().string,body:l().arrayOf(l().shape({})),numberLink:l().string,valueLink:l().string,nameLink:l().string,nameDataList:l().arrayOf(l().string),nameLinksList:l().arrayOf(l().string)}).isRequired,columnsSize:l().shape({name:l().string,number:l().string,value:l().string}),truncationLength:l().shape({name:l().number,number:l().number,value:l().number}),disableTruncation:l().shape({name:l().bool,number:l().bool,value:l().bool})},z.defaultProps={columnsSize:{name:null,number:null,value:null},truncationLength:{name:null,number:null,value:null},disableTruncation:{name:void 0,number:void 0,value:void 0}};const H=z;var M=function(e){return n.createElement("div",{className:"numbers-table-card"},n.createElement("div",{className:"numbers-left"},n.createElement(A,{data:e.data.numbersIndicator,options:e.options})),n.createElement("div",{className:"table-right"},n.createElement(H,{data:e.data.tableData,columnsSize:e.options.columnsSize,truncationLength:e.options.truncationLength,disableTruncation:e.options.disableTruncation})))};M.propTypes={data:l().shape({numbersIndicator:l().shape({first:l().shape({link:l().string,value:l().number,subtitle:l().string}).isRequired,second:l().shape({link:l().string,value:l().number,subtitle:l().string}).isRequired,third:l().shape({link:l().string,value:l().number,subtitle:l().string}).isRequired}).isRequired,tableData:l().shape({number:l().string,name:l().string,value:l().string,body:l().arrayOf(l().shape({}))}).isRequired}).isRequired,options:l().shape({columnsSize:l().shape({name:l().string,number:l().string,value:l().string}),truncationLength:l().shape({name:l().number,number:l().number,value:l().number}),disableTruncation:l().shape({name:l().bool,number:l().bool,value:l().bool})}).isRequired};const K=M;var U=r(26216);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y(n.key),n)}}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(W=function(){return!!e})()}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function Y(e){var t=function(e){if("object"!=B(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==B(t)?t:t+""}var Z=function(e){function t(e){var r,n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t,r){return t=$(t),function(e,t){if(t&&("object"==B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,W()?Reflect.construct(t,r||[],$(e).constructor):t.apply(e,r))}(this,t,[e]),n=r,i=function(e,t,n){var a=e.target,i="",o=r.state.timeFrame||null,l=r.state.locationSelected||null;if("locationSelector"===a.id){i=null!==o?"querySize=".concat(o,"&"):i,i="".concat(i,"destinationLocation=").concat(a.value);var s=r.props.allLocations.find((function(e){return e.id===a.value}));r.setState({locationSelected:s})}"timeFrameSelector"===e.target.id&&(i="querySize=".concat(a.value),i=null!==l?"".concat(i,"&destinationLocation=").concat(l.id):i,r.setState({timeFrame:a.value})),"yearTypeSelector"===e.target.id&&r.props.yearTypeFilter&&(i="".concat(r.props.yearTypeFilter.parameter||"querySize","=").concat(a.value),r.setState({yearType:a.value})),""!==i&&n(r.props.widgetId,i),a.size=1},(a=Y(a="handleChange"))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i,r.state={timeFrame:6,locationSelected:"",yearType:""},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(t,e),r=t,a=[{key:"render",value:function(){var e=this;return n.createElement("div",{className:"data-filter"},this.props.locationFilter&&n.createElement("select",{className:"location-filter custom-select",size:"1",onFocus:function(e){e.target.size=3},onBlur:function(e){e.target.size=1},onChange:function(t){return e.handleChange(t,e.props.cardId,e.props.loadIndicator)},disabled:!this.props.locationFilter,value:this.state.locationSelected.id,id:"locationSelector"},this.props.allLocations.map((function(t){return t.name.code&&t.name.message?n.createElement("option",{key:t.id,value:t.id},e.props.translate(t.name.code,t.name.message)):n.createElement("option",{key:t.id,value:t.id}," ",t.name)}))),this.props.timeFilter&&n.createElement("select",{className:"time-filter custom-select",onChange:function(t){return e.handleChange(t,e.props.cardId,e.props.loadIndicator)},disabled:!this.props.timeFilter,defaultValue:this.state.timeFrame,id:"timeFrameSelector"},n.createElement("option",{value:"1"},this.props.translate(this.props.label[0],this.props.label[1],{number:"",timeUnit:this.props.translate("react.dashboard.timeFilter.month.label","Month")})),n.createElement("option",{value:"3"},this.props.translate(this.props.label[0],this.props.label[1],{number:3,timeUnit:this.props.translate("react.dashboard.timeFilter.months.label","Months")})),n.createElement("option",{value:"6"},this.props.translate(this.props.label[0],this.props.label[1],{number:6,timeUnit:this.props.translate("react.dashboard.timeFilter.months.label","Months")})),(this.props.timeLimit>=12||!this.props.timeLimit)&&n.createElement("option",{value:"12"},this.props.translate(this.props.label[0],this.props.label[1],{number:"",timeUnit:this.props.translate("react.dashboard.timeFilter.year.label","Year")})),24===this.props.timeLimit&&n.createElement("option",{value:"24"},this.props.translate(this.props.label[0],this.props.label[1],{number:2,timeUnit:this.props.translate("react.dashboard.timeFilter.years.label","Years")}))),this.props.yearTypeFilter&&n.createElement("select",{className:"time-filter custom-select",onChange:function(t){return e.handleChange(t,e.props.cardId,e.props.loadIndicator)},disabled:!this.props.yearTypeFilter,defaultValue:this.state.yearType||this.props.yearTypeFilter.defaultValue,id:"yearTypeSelector"},this.props.yearTypeFilter.options&&this.props.yearTypeFilter.options.map((function(t){return n.createElement("option",{value:t.value},e.props.translate(t.label,t.label))}))))}}],a&&J(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(n.Component),G=function(e){var t=e[0]._chart.data.datasets[0].links[e[0]._index];t&&""!==t&&(window.location=t)},X=(0,u.Zj)((function(e){var t,r=e.cardId,a=e.widgetId,i=e.cardTitle,o=e.cardType,l=e.cardLink,c=e.cardInfo,u=e.data,d=e.options,p=e.loadIndicator,f=e.timeFilter,m=void 0!==f&&f,h=e.yearTypeFilter,g=void 0===h?null:h,b=e.timeLimit,y=void 0===b?24:b,v=e.locationFilter,E=void 0!==v&&v,w=e.allLocations,S=e.size,C=void 0===S?null:S,N=e.translate,R=e.hideDraghandle,D=["react.dashboard.timeFilter.last.label","last ${0} ${1}"];return"line"===o?(u.labels&&u.labels[0].code&&u.labels[0].message&&(u.labels=u.labels.map((function(e){return N(e.code,e.message)}))),t=n.createElement(s.N1,{data:u,options:d,onElementsClick:function(e){return G(e)}}),D=["react.dashboard.timeFilter.next.label","next ${0} ${1}"]):"bar"===o?t=n.createElement(s.yP,{data:u,options:d}):"doughnut"===o?t=n.createElement(s.nu,{data:u,options:d}):"horizontalBar"===o?t=n.createElement(s.HorizontalBar,{data:u,options:d,onElementsClick:function(e){return G(e)}}):"numbers"===o?t=n.createElement(A,{data:u,options:d}):"numbersCustomColors"===o?t=n.createElement(x,{data:u}):"table"===o?t=n.createElement(H,{data:u}):"numberTable"===o?t=n.createElement(K,{data:u,options:d}):"loading"===o?t=n.createElement(q,null):"error"===o&&(t=n.createElement("button",{type:"button",onClick:function(){return p(a)}},n.createElement("i",{className:"fa fa-repeat"}))),n.createElement("div",{className:"graph-card ".concat("big"===C?"big-size":""," ").concat("error"===o?"error-card":"")},n.createElement("div",{className:"header-card"},l?n.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:l,className:"title-link"},n.createElement("span",{className:"title-link"},N(i,i))):n.createElement("span",{className:"title-link"},N(i,i)),c?n.createElement("div",{className:"graph-infos"},n.createElement(I.Tooltip,{html:n.createElement("p",null,N(c,c)),theme:"transparent",arrow:"true"},n.createElement("i",{className:"fa fa-info-circle"}))):null,!R&&n.createElement(O,null)),n.createElement("div",{className:"content-card"},n.createElement(Z,{cardId:r,widgetId:a,loadIndicator:p,locationFilter:E,timeLimit:y,timeFilter:m,yearTypeFilter:g,label:D,data:0===u.length?null:u,allLocations:w,translate:N}),n.createElement("div",{className:"graph-container"},t)))}));const Q=(0,c.Ng)((function(e){return{translate:(0,U.H)((0,N.ro)(e.localize))}}))(X);X.propTypes={cardTitle:l().string.isRequired,cardType:l().string.isRequired,cardInfo:l().string.isRequired,timeLimit:l().number,loadIndicator:l().func.isRequired,translate:l().func.isRequired},Z.defaultProps={timeFilter:!1,locationFilter:!1,yearTypeFilter:null},Z.propTypes={locationFilter:l().bool,timeFilter:l().bool,yearTypeFilter:l().shape({parameter:l().string,defaultValue:l().string,options:l().arrayOf(l().shape({}))}),timeLimit:l().number.isRequired,label:l().arrayOf(l().string.isRequired).isRequired,cardId:l().number.isRequired,widgetId:l().string.isRequired,loadIndicator:l().func.isRequired,allLocations:l().arrayOf(l().shape({})).isRequired,translate:l().func.isRequired};const ee=function(){for(var e=[],t=0;t<4;t+=1)e.push(n.createElement("div",{className:"number-card",key:t},n.createElement("div",{className:"loader-div"},n.createElement(D(),{type:"bubbles",color:(0,T.NP)(),height:"100px",width:"100px"}))));return n.createElement("div",{className:"card-component"},e)};var te={responsive:!0,maintainAspectRatio:!0,legend:{display:!1},elements:{line:{borderColor:"#000000",borderWidth:1},point:{radius:0}},tooltips:{enabled:!1},scales:{yAxes:[{display:!1}],xAxes:[{display:!1}]},plugins:{datalabels:{display:!1}}},re=function(e){var t=e.cardTitle,r=e.cardInfo,a=e.color,i=e.value,o=e.goalDifference,l=e.sparklineData,c=e.translate;return n.createElement("div",{className:"number-div"},n.createElement("div",{className:"number-body"},n.createElement("span",{className:"title-card"},c(t,t)),n.createElement("div",{className:"result-part"},n.createElement("span",{style:{color:(0,T.Er)(a,"default")}}," ",i," "),n.createElement("span",{className:"goal-difference"}," ",o," ")),n.createElement(s.N1,{data:l,options:te,height:25})),n.createElement("div",{className:"number-infos"},n.createElement(I.Tooltip,{html:n.createElement("p",null," ",c(r,r)," "),theme:"transparent",arrow:"true",disabled:!r},n.createElement("i",{className:"fa fa-info-circle"}))),n.createElement(O,null))},ne=(0,u.Zj)((function(e){var t=e.cardTitle,r=e.cardNumber,a=e.cardNumberType,i=e.cardSubtitle,o=e.cardLink,l=e.cardDataTooltip,s=e.cardInfo,c=e.sparklineData,u=void 0===c?null:c,d=e.translate,p=e.currencyCode,f=e.hideDraghandle,m=!1;null!=u&&null!=u.colorNumber&&(m=!0);var h=r?r.toLocaleString():(0).toLocaleString(),g=m?n.createElement(re,{cardTitle:t,cardInfo:s,color:u.colorNumber.color,value:u.colorNumber.value,goalDifference:u.colorNumber.value2,sparklineData:u,translate:d}):n.createElement(I.Tooltip,{html:n.createElement("p",{style:{whiteSpace:"pre"}}," ",l," "),theme:"transparent",arrow:"true",disabled:!l},n.createElement("div",{className:"number-div"},n.createElement("div",{className:"number-body"},n.createElement("span",{className:"title-card"},d(t,t)),n.createElement("span",{className:"result-card"}," ","number"===a?h:"".concat(h," ").concat(p)," "),n.createElement("span",{className:"subtitle-card text-overflow-ellipsis text-nowrap"},d(i,i))),s?n.createElement("div",{className:"number-infos"},n.createElement(I.Tooltip,{html:n.createElement("p",null,d(s,s)),theme:"transparent",arrow:"true"},n.createElement("i",{className:"fa fa-info-circle"}))):null,!f&&n.createElement(O,null)));return o?n.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o,className:"number-card"},g):n.createElement("div",{className:"number-card"},g)}));const ae=(0,c.Ng)((function(e){return{translate:(0,U.H)((0,N.ro)(e.localize)),currencyCode:e.session.currencyCode}}))(ne);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){se(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function se(e,t,r){return(t=function(e){var t=function(e){if("object"!=ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ce(e){return function(e){if(Array.isArray(e))return ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ue(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ue(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}ne.defaultProps={cardSubtitle:""},ne.propTypes={cardTitle:l().string.isRequired,cardNumber:l().number,cardNumberType:l().string,cardSubtitle:l().string,cardLink:l().string,cardDataTooltip:l().string,cardInfo:l().string.isRequired,translate:l().func.isRequired,currencyCode:l().string.isRequired},re.propTypes={cardTitle:l().string.isRequired,cardInfo:l().string.isRequired,color:l().string.isRequired,value:l().string.isRequired,goalDifference:l().string.isRequired,sparklineData:l().shape({}).isRequired,translate:l().func.isRequired};var de=function(){var e=["green","yellow","red"],t="circle ".concat(e[i().random(0,e.length-1)]);return n.createElement("div",{className:"value"},n.createElement("div",{className:t})," ",i().random(3,95))},pe=function(e){return n.createElement("li",{className:"unarchived-item"},n.createElement("div",{className:"archived-indicator"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col col-3 graph-preview"},e.children),n.createElement("div",{className:"col col-6"},n.createElement("span",{className:"w-100 text-overflow-ellipsis text-nowrap text-left"},e.translate(e.title,e.title))),n.createElement("div",{className:"col col-3"},n.createElement("span",{role:"button",tabIndex:0,className:"unarchive-button",onClick:function(){return e.handleAdd(e.widgetId)},onKeyDown:function(){return e.handleAdd(e.widgetId)}},"Unarchive")))))},fe=function(e){return n.createElement(pe,{title:e.title,index:e.index,widgetId:e.widgetId,handleAdd:e.handleAdd,type:"number",translate:e.translate},n.createElement("span",null,i().random(3,95)))},me=function(e){var t;return"line"===e.type?t=n.createElement("i",{className:"fa fa-line-chart",style:{color:(0,T.NP)()}}):"bar"===e.type||"numbersCustomColors"===e.type?t=n.createElement("i",{className:"fa fa-bar-chart",style:{color:(0,T.NP)()}}):"doughnut"===e.type?t=n.createElement("i",{className:"fa fa-pie-chart",style:{color:(0,T.NP)()}}):"horizontalBar"===e.type?t=n.createElement("i",{className:"fa fa-bar-chart horizontal-bar",style:{color:(0,T.NP)()}}):"numbers"===e.type?t=n.createElement(de,null):"loading"===e.type?t=n.createElement(D(),{type:"bubbles",color:(0,T.NP)(),height:"40px",width:"40px"}):"error"===e.type?t=n.createElement("i",{className:"fa fa-repeat"}):"table"!==e.type&&"numberTable"!==e.type||(t=n.createElement("i",{className:"fa fa-table",style:{color:(0,T.NP)()}})),n.createElement(pe,{title:e.title,index:e.index,widgetId:e.widgetId,handleAdd:e.handleAdd,type:"graph",translate:e.translate},t)},he=function(e){return n.createElement("div",null,e.widgets.map((function(t,r){return"number"===t.type?n.createElement(fe,{key:"item-".concat(t.widgetId),index:r,widgetId:t.widgetId,title:t.title,handleAdd:e.handleAdd,unarchiveHandler:e.unarchiveHandler,size:e.size,translate:e.translate}):n.createElement(me,{key:"item-".concat(t.widgetId),index:r,widgetId:t.widgetId,title:t.title,type:t.graphType,handleAdd:e.handleAdd,unarchiveHandler:e.unarchiveHandler,size:e.size,translate:e.translate})})))},ge=function(e){var t=[].concat(ce(e.graphData),ce(e.numberData)),r=i().chain(t).filter((function(e){return e&&e.widgetId})).map((function(e){return e.widgetId})).value(),a=i().chain(e.dashboardConfig.dashboardWidgets).omit(r).map((function(e,t){return le(le({},e),{},{widgetId:t})})).filter((function(e){return e.enabled})).value(),o=i().size(a);return n.createElement("div",{className:e.showPopout?"unarchived-items popover-active":"unarchived-items"},n.createElement("div",{className:"unarchive",role:"button",tabIndex:0,onClick:e.unarchiveHandler,onKeyDown:e.unarchiveHandler},n.createElement("span",null,"Archived Indicators (",o,") ",n.createElement("i",{className:"fa fa-archive"}))),n.createElement("div",{className:"unarchive-popover"},n.createElement("span",{role:"button",tabIndex:0,className:"close-button",onClick:e.unarchiveHandler,onKeyDown:e.unarchiveHandler},"Ã—"),n.createElement("ul",{className:"unarchived-list"},n.createElement(he,{widgets:a,handleAdd:e.handleAdd,unarchiveHandler:e.unarchiveHandler,size:o,translate:e.translate}))))};const be=(0,c.Ng)((function(e){return{translate:(0,U.H)((0,N.ro)(e.localize))}}))(ge);function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oe(n.key),n)}}function Se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Se=function(){return!!e})()}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}function Ne(e,t){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ne(e,t)}function Ie(e,t,r){return(t=Oe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oe(e){var t=function(e){if("object"!=ye(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ye(t)?t:t+""}function Re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return De(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}ge.propTypes={graphData:l().arrayOf(l().shape({})).isRequired,numberData:l().arrayOf(l().shape({})).isRequired,dashboardConfig:l().shape({dashboard:l().shape({}),dashboardWidgets:l().shape({})}).isRequired,unarchiveHandler:l().func.isRequired,handleAdd:l().func.isRequired,showPopout:l().bool.isRequired,translate:l().func.isRequired},pe.propTypes={title:l().oneOfType([l().string.isRequired,l().shape({code:l().string.isRequired,message:l().string.isRequired}).isRequired]).isRequired,handleAdd:l().func.isRequired,widgetId:l().string.isRequired,children:l().node.isRequired,translate:l().func.isRequired},me.propTypes={type:l().string.isRequired,title:l().oneOfType([l().string.isRequired,l().shape({code:l().string.isRequired,message:l().string.isRequired}).isRequired]).isRequired,handleAdd:l().func.isRequired,index:l().number.isRequired,widgetId:l().string.isRequired,translate:l().func.isRequired},fe.propTypes={title:l().oneOfType([l().string.isRequired,l().shape({code:l().string.isRequired,message:l().string.isRequired}).isRequired]).isRequired,handleAdd:l().func.isRequired,index:l().number.isRequired,widgetId:l().string.isRequired,translate:l().func.isRequired},he.propTypes={widgets:l().arrayOf(l().shape({})).isRequired,unarchiveHandler:l().func.isRequired,handleAdd:l().func.isRequired,size:l().number.isRequired,translate:l().func.isRequired},s.defaults.scale.ticks.beginAtZero=!0;var Te=(0,u.q6)((function(e){var t=e.data,r=e.loadIndicator,a=e.allLocations,i=e.personalDashboardActive;return n.createElement("div",{className:"card-component"},t.map((function(e,t){return e&&n.createElement(Q,{key:"item-".concat(e.id),index:t,cardId:e.id,widgetId:e.widgetId,cardTitle:e.title,cardType:e.type,cardLink:e.link,cardInfo:e.info,data:e.data,timeFilter:e.timeFilter,timeLimit:e.timeLimit,locationFilter:e.locationFilter,yearTypeFilter:e.yearTypeFilter,options:e.options,loadIndicator:r,allLocations:a,size:e.size,disabled:!i,hideDraghandle:!i})})))})),qe=(0,u.q6)((function(e){var t=e.data,r=e.personalDashboardActive;return n.createElement("div",{className:"card-component"},t.map((function(e,t){return e&&n.createElement(ae,{key:"item-".concat(e.id),index:t,widgetId:e.widgetId,cardTitle:e.title,cardNumberType:e.numberType,cardNumber:e.number,cardSubtitle:e.subtitle,cardLink:e.link,cardDataTooltip:e.tooltipData,cardInfo:e.info,sparklineData:e.data,disabled:!r,hideDraghandle:!r})})))})),ke=function(e){var t=e.hideArchive;return n.createElement("div",{className:t?"archive-div hide-archive":"archive-div"},n.createElement("span",null,n.createElement(U.A,{id:"react.dashboard.archive.label",defaultMessage:"Archive indicator"}),n.createElement("i",{className:"fa fa-archive ml-2"})))},Fe=function(e){var t=e.configs,r=e.activeConfig,a=e.loadConfigData,i=e.showNav,o=e.toggleNav,l=e.configModified,s=e.updateConfig;return t?n.createElement("div",{className:"configs-left-nav ".concat(i?"":"hidden")},n.createElement("button",{type:"button",className:"toggle-nav",onClick:o},i?n.createElement("i",{className:"fa fa-chevron-left","aria-hidden":"true"}):n.createElement("i",{className:"fa fa-chevron-right","aria-hidden":"true"})),n.createElement("ul",{className:"configs-list"},Object.entries(t).map((function(e){var t=Re(e,2),i=t[0],o=t[1];return n.createElement("li",{className:"configs-list-item ".concat(r===i?"active":""),key:i},n.createElement("button",{type:"button",onClick:function(){return a(i)}},n.createElement("i",{className:"fa fa-bar-chart","aria-hidden":"true"}),n.createElement(U.A,{id:"react.dashboard.".concat(i,".label"),defaultMessage:o.name})))}))),"personal"===r&&l?n.createElement("div",{className:"update-section"},n.createElement("div",{className:"division-line"}),n.createElement("span",null,n.createElement("i",{className:"fa fa-info-circle","aria-hidden":"true"}),n.createElement(U.A,{id:"react.dashboard.hasBeenEdited.message",defaultMessage:"The dashboard layout has been edited"})),n.createElement("button",{type:"button",onClick:s},n.createElement("i",{className:"fa fa-floppy-o","aria-hidden":"true"}),n.createElement(U.A,{id:"react.dashboard.saveConfiguration.label",defaultMessage:"Save configuration"}))):null):null},Pe=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ie(r=function(e,t,r){return t=Ce(t),function(e,t){if(t&&("object"==ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Se()?Reflect.construct(t,r||[],Ce(e).constructor):t.apply(e,r))}(this,t,[e]),"dataFetched",!1),Ie(r,"fetchData",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"personal";sessionStorage.setItem("dashboardKey",e),r.props.resetIndicators(),r.props.dashboardConfig&&r.props.dashboardConfig.dashboard?(r.props.fetchIndicators(r.props.dashboardConfig,e,r.props.currentLocation,r.props.currentUser),r.loadPageFilters(e)):r.props.fetchConfigAndData(r.props.currentLocation,e,r.props.currentUser,r.getDashboardIdFromParams())})),Ie(r,"updateConfig",(function(){var e=[];i().forEach(r.props.indicatorsData,(function(t,r){e.push({widgetId:t.widgetId,order:r+1})})),i().forEach(r.props.numberData,(function(t,r){e.push({widgetId:t.widgetId,order:r+1})}));var t=Ee(Ee({},r.props.dashboardConfig.dashboard),{},Ie({},r.props.activeConfig,Ee(Ee({},r.props.dashboardConfig.dashboard[r.props.activeConfig]),{},{widgets:e})));p.Ay.post("/api/dashboard/config",t).then((function(){r.props.fetchConfig(r.getDashboardIdFromParams()),r.setState({configModified:!1})}))})),Ie(r,"loadIndicator",(function(e,t){var n=r.props.dashboardConfig.dashboard[r.props.activeConfig],a=i().find(n.widgets,(function(t){return t.widgetId===e})),o=Ee(Ee({},r.props.dashboardConfig.dashboardWidgets[e]),a);r.props.reloadIndicator(o,t,r.props.currentLocation)})),Ie(r,"toggleNav",(function(){r.setState((function(e){return{showNav:!e.showNav}}))})),Ie(r,"sortStartHandle",(function(){r.setState({isDragging:!0})})),Ie(r,"sortEndHandle",(function(e,t,n){var a=e.oldIndex,i=e.newIndex,o=window.innerHeight-(6*window.innerHeight/100+80);t.clientY>o&&(t.target.id="archive"),r.props.reorderIndicators({oldIndex:a,newIndex:i},t,n),"personal"!==r.props.activeConfig||a===i&&"archive"!==t.target.id?r.setState({isDragging:!1}):r.setState({configModified:!0,isDragging:!1})})),Ie(r,"sortEndHandleNumber",(function(e,t){var n=e.oldIndex,a=e.newIndex;r.sortEndHandle({oldIndex:n,newIndex:a},t,"number")})),Ie(r,"sortEndHandleGraph",(function(e,t){var n=e.oldIndex,a=e.newIndex;r.sortEndHandle({oldIndex:n,newIndex:a},t,"graph")})),Ie(r,"unarchiveHandler",(function(){i().size(r.props.dashboardConfig.dashboardWidgets)-(r.props.indicatorsData.length+r.props.numberData.length)?r.setState((function(e){return{showPopout:!e.showPopout}})):r.setState({showPopout:!1})})),Ie(r,"handleAdd",(function(e){var t=r.props.dashboardConfig.dashboardWidgets[e],n=Ee(Ee({},t),{},{widgetId:e,order:("number"===t.type?r.props.numberData.length:r.props.indicatorsData.length)+1});r.props.addToIndicators(n,r.props.currentLocation,r.props.currentUser);var a=i().size(r.props.dashboardConfig.dashboardWidgets)-(r.props.indicatorsData.length+r.props.numberData.length);"personal"===r.props.activeConfig?r.setState({configModified:!0,showPopout:a>0}):r.setState({showPopout:a>0})})),r.state={isDragging:!1,showPopout:!1,showNav:window.innerWidth>1115,configModified:!1,allLocations:[],pageFilters:[],subdashboardKeys:[]},r.fetchLocations(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}(t,e),r=t,a=[{key:"componentDidMount",value:function(){var e=this;""!==this.props.currentLocation&&this.getSubdashboardKeys().then((function(){return e.fetchData(e.determineActiveConfig())})),this.loadPageFilters(this.props.activeConfig)}},{key:"componentDidUpdate",value:function(e){var t=this;e.currentLocation!==this.props.currentLocation&&this.getSubdashboardKeys().then((function(){return t.fetchData(t.determineActiveConfig())})),e.dashboardConfig.dashboard!==this.props.dashboardConfig.dashboard&&this.loadPageFilters(this.props.activeConfig)}},{key:"getDashboardIdFromParams",value:function(){var e=this.props.match.params.configId;return e&&"index"!==e?e:"mainDashboard"}},{key:"getSubdashboardKeys",value:function(){var e=this,t=this.getDashboardIdFromParams(),r="/api/dashboard/".concat(t,"/subdashboardKeys");return p.Ay.get(r).then((function(t){var r=t.data;r&&e.setState({subdashboardKeys:r})}))}},{key:"determineActiveConfig",value:function(){if(this.props.match.params.configId&&"index"!==this.props.match.params.configId)return this.props.match.params.configId;var e=sessionStorage.getItem("dashboardKey");return e&&this.state.subdashboardKeys.includes(e)?e:"personal"}},{key:"loadPageFilters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];this.props.dashboardConfig.dashboard&&Object.entries(this.props.dashboardConfig.dashboard).map((function(e){var t=Re(e,2);return[t[0],t[1]]})).forEach((function(r){if(r[1].filters){var n=Object.entries(r[1].filters).map((function(e){var t=Re(e,2);return{name:t[0],endpoint:t[1].endpoint}}));n.length>0&&r[0]===e&&(t=n)}})),this.setState({pageFilters:t})}},{key:"fetchLocations",value:function(){var e=this;return p.Ay.get("/api/dashboard/fillRateDestinations").then((function(t){e.setState({allLocations:t.data.data.sort((function(e,t){return e.id.localeCompare(t.id)}))})}))}},{key:"isPersonalDashboardActive",value:function(){return"personal"===this.props.activeConfig}},{key:"render",value:function(){var e,t=this.isPersonalDashboardActive();return e=this.props.numberData.length?n.createElement(qe,{data:this.props.numberData,onSortStart:this.sortStartHandle,onSortEnd:this.sortEndHandleNumber,axis:"xy",useDragHandle:!0,personalDashboardActive:t}):n.createElement(ee,null),n.createElement("div",{className:"dashboard-container"},n.createElement(Fe,{configs:this.props.dashboardConfig.dashboard||{},loadConfigData:this.fetchData,activeConfig:this.props.activeConfig,showNav:this.state.showNav,toggleNav:this.toggleNav,configModified:this.state.configModified,updateConfig:this.updateConfig}),n.createElement("div",{className:"overlay ".concat(this.state.showNav?"visible":""),"aria-label":"button",role:"button",tabIndex:0,onClick:this.toggleNav,onKeyPress:this.toggleNav}),n.createElement("div",{className:"filter-and-cards-container"},n.createElement(C,{configs:this.props.dashboardConfig.dashboard||{},activeConfig:this.props.activeConfig,fetchData:this.fetchData,pageFilters:this.state.pageFilters}),n.createElement("div",{className:"cards-container"},e,n.createElement(Te,{allLocations:this.state.allLocations,data:this.props.indicatorsData.filter((function(e){return e})),onSortStart:this.sortStartHandle,onSortEnd:this.sortEndHandleGraph,loadIndicator:this.loadIndicator,axis:"xy",useDragHandle:!0,personalDashboardActive:t}),n.createElement(ke,{hideArchive:!this.state.isDragging}),t&&n.createElement(be,{graphData:this.props.indicatorsData,numberData:this.props.numberData,dashboardConfig:this.props.dashboardConfig,activeConfig:this.props.activeConfig,showPopout:this.state.showPopout,unarchiveHandler:this.unarchiveHandler,handleAdd:this.handleAdd}))))}}],a&&we(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(n.Component);const je=(0,c.Ng)((function(e){return{indicatorsData:e.indicators.data,numberData:e.indicators.numberData,dashboardConfig:e.indicators.config,activeConfig:e.indicators.activeConfig,currentLocation:e.session.currentLocation.id,currentUser:e.session.user.id}}),{fetchIndicators:d.zN,reloadIndicator:d.pO,addToIndicators:d.lJ,reorderIndicators:d.EY,resetIndicators:d.Uw,fetchConfigAndData:d.E,fetchConfig:d.Dz})(Pe);Pe.defaultProps={currentLocation:"",currentUser:"",indicatorsData:null,numberData:[],match:{params:{configId:"personal"}}},Pe.propTypes={fetchIndicators:l().func.isRequired,reorderIndicators:l().func.isRequired,indicatorsData:l().arrayOf(l().shape({id:l().number})),numberData:l().arrayOf(l().shape({id:l().number})),dashboardConfig:l().shape({dashboard:l().shape({}),dashboardWidgets:l().shape({})}).isRequired,activeConfig:l().string.isRequired,currentLocation:l().string,currentUser:l().string,addToIndicators:l().func.isRequired,reloadIndicator:l().func.isRequired,resetIndicators:l().func.isRequired,fetchConfigAndData:l().func.isRequired,fetchConfig:l().func.isRequired,match:l().shape({params:l().shape({configId:l().string})})},ke.propTypes={hideArchive:l().bool.isRequired},Fe.propTypes={configs:l().shape({}).isRequired,activeConfig:l().string.isRequired,loadConfigData:l().func.isRequired,showNav:l().bool.isRequired,toggleNav:l().func.isRequired,updateConfig:l().func.isRequired,configModified:l().bool.isRequired}}}]);
//# sourceMappingURL=bundle.929af1b45eb780bfc503.990.js.map