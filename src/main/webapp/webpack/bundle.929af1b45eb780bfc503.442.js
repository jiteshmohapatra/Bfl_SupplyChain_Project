/*! For license information please see bundle.929af1b45eb780bfc503.442.js.LICENSE.txt */
"use strict";(self.webpackChunkopenboxes=self.webpackChunkopenboxes||[]).push([[442],{37007:e=>{var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}p(e,t,i,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var o,i,a,c;if(u(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=l(e))>0&&a.length>o&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,c=s,console&&console.warn&&console.warn(c)}return e}function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=s.bind(r);return o.listener=n,r.wrapFn=o,o}function f(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):m(o,o.length)}function v(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function p(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,s=m(l,c);for(n=0;n<c;++n)r(s[n],this,t)}return!0},i.prototype.addListener=function(e,t){return c(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return c(this,e,t,!0)},i.prototype.once=function(e,t){return u(t),this.on(e,d(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,d(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,o,i,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},i.prototype.listenerCount=v,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},70442:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Le});var r=n(96540),o=n(34860),i=n(5556),a=n.n(i),u=n(41357),l=n(42164),c=n(50709),s=n(14044),d=n(44088),f=n(15516),v=n(79352),m=n(26216),p=n(78093),y=function(e){var t=e.next,n=e.save,o=e.printRecountForm,i=e.refreshCountItems,a=(0,f.A)();return r.createElement("div",{className:"d-flex justify-content-sm-between align-items-end"},r.createElement(v.A,{label:"react.cycleCount.redirectToResolveTab.label",defaultMessage:"Back to Resolve tab",redirectTo:c.BC.list(s.v0),className:"pt-5"}),r.createElement("div",{className:"d-flex gap-8"},r.createElement("div",{className:"btn-group"},r.createElement(l.A,{isDropdown:!0,defaultLabel:"Print recount form",label:"react.cycleCount.printRecountForm.label",variant:"primary-outline",StartIcon:r.createElement(u.GD9,{size:18})}),r.createElement("div",{className:"dropdown-menu dropdown-menu-right nav-item padding-8","aria-labelledby":"dropdownMenuButton"},r.createElement("a",{href:"#",className:"dropdown-item",onClick:function(){return o(d.A.PDF)},role:"button"},r.createElement(m.A,{id:"react.cycleCount.printRecountFormPdf.label",defaultMessage:"Print Recount Form PDF"})),r.createElement("a",{href:"#",className:"dropdown-item",onClick:function(){return o(d.A.XLS)},role:"button"},r.createElement(m.A,{id:"react.cycleCount.exportRecountSheet.label",defaultMessage:"Export Recount Sheet"})))),r.createElement(p.A,{content:a("react.cycleCount.table.refreshQuantitiesTooltip.label","Fix missing or transaction error on this product and Refresh to see updated discrepancies.")},r.createElement(l.A,{onClick:i,label:"react.default.button.refresh.label",defaultLabel:"Reload",variant:"primary"})),r.createElement(l.A,{onClick:n,label:"react.cycleCount.save.label",defaultLabel:"Save progress",variant:"primary",StartIcon:r.createElement(u.vUL,{size:18})}),r.createElement(l.A,{onClick:t,label:"react.default.button.next.label",defaultLabel:"Next",variant:"primary"})))};const h=y;y.propTypes={next:a().func.isRequired,save:a().func.isRequired,printRecountForm:a().func.isRequired,refreshCountItems:a().func.isRequired};var b=n(697),g=n(51836),C=n(56934),E=n(82486),w=n(62326),A=n(67911),R=n(80077),O=n(62775),N=n(37007),x=n(33888),I=n(2543),L=n.n(I),T=n(8949),S=n(62969),_=n(61965),D=n(26409),j={EQUAL:"EQUAL",EMPTY:"EMPTY",POSITIVE:"POSITIVE",NEGATIVE:"NEGATIVE"},q=function(e,t){return Number.isNaN(e)||null===t?null:e>0?j.POSITIVE:e<0?j.NEGATIVE:j.EQUAL};const M=j;var P=function(e){var t=e.value,n=e.variant,o=e.showAbsoluteValue,i=(0,f.A)(),a=o?Math.abs(t):t;return n===M.POSITIVE?r.createElement("div",null,r.createElement(u.avw,{size:18,className:"arrow-value-indicator--positive"}),r.createElement("span",{className:"value-indicator value-indicator--positive"},a.toString())):n===M.NEGATIVE?r.createElement("div",null,r.createElement(u.RFQ,{size:18,className:"arrow-value-indicator--negative"}),r.createElement("span",{className:"value-indicator value-indicator--negative"},a.toString())):n===M.EQUAL?r.createElement("div",{className:"px-2 py-1 value-indicator value-indicator--equal"},i("react.cycleCount.table.equal.label","EQUAL")):n===M.EMPTY?r.createElement("div",{className:"py-1 text-center value-indicator value-indicator--empty"},"-"):null};const k=P;P.propTypes={value:a().oneOfType([a().string,a().number]),variant:a().oneOf(Object.keys(M)).isRequired,showAbsoluteValue:a().bool},P.defaultProps={value:null,showAbsoluteValue:!1};var F=n(87054),B=n(19622),U=n(52725),Y=n(20531),V=n(85728),z=n(91019);function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Q.apply(null,arguments)}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var G=function(e){var t,n=e.id,o=e.product,i=e.dateCounted,a=e.dateRecounted,c=e.tableData,s=e.tableMeta,d=e.addEmptyRow,v=e.removeRow,m=e.assignRecountedBy,y=e.recountedBy,h=e.countedBy,I=e.setRecountedDate,j=e.validationErrors,P=e.shouldHaveRootCause,H=e.isFormValid,G=e.isStepEditable,X=e.triggerValidation,K=e.refreshFocusCounter,$=function(e){var t=e.cycleCountId,n=e.removeRow,o=e.triggerValidation,i=e.validationErrors,a=e.shouldHaveRootCause,l=e.isStepEditable,c=e.tableData,s=e.productId,d=e.addEmptyRow,v=e.refreshFocusCounter,m=(0,x.FB)(),y=W((0,r.useState)(null),2),h=y[0],C=y[1],E=W((0,r.useState)(null),2),w=E[0],I=E[1],j=W((0,r.useState)(0),2),P=j[0],H=j[1],G=(0,f.A)(),X=new N.EventEmitter,K=(0,b.d4)((function(e){return{users:e.users.data,currentLocation:e.session.currentLocation,formatLocalizedDate:(0,z.Yq)(e.localize),reasonCodes:e.cycleCount.reasonCodes,binLocations:e.cycleCount.binLocations}})),$=K.users,J=K.currentLocation,Z=K.formatLocalizedDate,ee=K.reasonCodes,te=K.binLocations,ne=(0,r.useMemo)((function(){return(0,V.Wx)(J.supportedActivities)}),[null==J?void 0:J.id]),re=(0,b.wA)();(0,r.useEffect)((function(){v!==P&&(C(null),I(null),H(v))}),[v]),(0,r.useEffect)((function(){null!=ee&&ee.length||re((0,T.xH)("ADJUST_INVENTORY",S.I_))}),[]);var oe=function(e,t){return e===B.A.EXPIRATION_DATE?Z(t,O.o.DD_MMM_YYYY):e===B.A.QUANTITY_COUNTED?null==t?void 0:t.toString():e===B.A.BIN_LOCATION?null==t?void 0:t.name:e===B.A.ROOT_CAUSE?null==t?void 0:t.label:t},ie={cell:function(e){var n,f=e.row,v=f.original,m=f.index,y=e.column.id,b=e.table,g=y.replaceAll("_","."),E=L().get(c,"[".concat(m,"].").concat(g)),N=W((0,r.useState)(E),2),x=N[0],T=N[1],S=!v.id.includes("newRow")&&![B.A.QUANTITY_RECOUNTED,B.A.ROOT_CAUSE,B.A.COMMENT].includes(y),D=[B.A.ROOT_CAUSE,B.A.COMMENT,B.A.BIN_LOCATION].includes(y);if(!l)return r.createElement(p.A,{content:oe(g,x),show:D},r.createElement(_.n,{className:"static-cell-count-step align-items-center resolve-table-limit-lines"},r.createElement("div",{className:D?"limit-lines-1":"limit-lines-3 text-break"},oe(g,x))));var j=null==i||null===(n=i[t])||void 0===n||null===(n=n.errors)||void 0===n||null===(n=n[m])||void 0===n||null===(n=n[g])||void 0===n?void 0:n._errors,q=W((0,r.useState)(j),2),M=q[0],P=q[1],k=W((0,r.useState)(M?null:a(null==v?void 0:v.id)),2),V=k[0],z=k[1],H=E!==x,K=function(){var e;if(H&&([B.A.BIN_LOCATION,B.A.ROOT_CAUSE].includes(y)||(null===(e=b.options.meta)||void 0===e||e.updateData(t,v.id,y,x),P(null),o()),y===B.A.QUANTITY_RECOUNTED)){var n,r=x?parseInt(x,10)||0:x;T(r),null===(n=b.options.meta)||void 0===n||n.updateData(t,v.id,y,r),X.emit("refreshRecountDifference")}};(0,r.useEffect)((function(){null!==h&&w&&null!==M&&P(null)}),[h,w]),(0,r.useEffect)((function(){var e;null===(e=b.options.meta)||void 0===e||e.updateData(t,v.id,y,x)}),[x]);var $,J=($=g,[B.A.QUANTITY_COUNTED,B.A.QUANTITY_RECOUNTED].includes($)?"number":"text"),Z=function(e){return e===B.A.EXPIRATION_DATE?A.A:[B.A.BIN_LOCATION,B.A.ROOT_CAUSE].includes(e)?R.A:F.A}(g),re=function(e,t,n){return e||(t&&n===B.A.ROOT_CAUSE?G("react.cycleCount.rootCauseWarning.label","Specify result of investigation if applicable."):null)}(j,V,g),ie=function(e,t){return e===B.A.BIN_LOCATION&&ne?{labelKey:"name",options:(0,Y.A)(te)}:e===B.A.ROOT_CAUSE?{options:ee,placeholder:r.createElement("span",{className:t?"pl-12px":""},G("react.cycleCount.selectPlaceholder.label","Select"))}:e===B.A.EXPIRATION_DATE?{customDateFormat:O.o.DD_MMM_YYYY}:{}}(g,re),ae=[B.A.LOT_NUMBER,B.A.EXPIRATION_DATE,B.A.QUANTITY_RECOUNTED,B.A.ROOT_CAUSE,B.A.COMMENT];ne&&ae.splice(0,0,B.A.BIN_LOCATION);var ue=[B.A.QUANTITY_RECOUNTED,B.A.ROOT_CAUSE,B.A.COMMENT],le=(0,U.A)({newRowFocusableCells:ae,existingRowFocusableCells:ue,tableData:c,setColumnId:I,setRowIndex:C,addNewRow:function(){return d(s,t,!1)},isNewRow:function(e){var t;return null==e||null===(t=e.id)||void 0===t?void 0:t.includes("newRow")},onBlur:K}).handleKeyDown,ce=[B.A.ROOT_CAUSE,B.A.COMMENT,B.A.EXPIRATION_DATE].includes(g),se=[B.A.ROOT_CAUSE,B.A.BIN_LOCATION].includes(y);return r.createElement(_.n,{className:"rt-td rt-td-count-step pb-0",customTooltip:se&&oe(y,x),tooltipClassname:"w-100",tooltipLabel:oe(y,x)},r.createElement(Z,Q({disabled:S,type:J,value:x,onChange:function(e){var t,n;[B.A.BIN_LOCATION,B.A.ROOT_CAUSE].includes(y)&&(P(null),z(null),o()),T(null!==(t=null==e||null===(n=e.target)||void 0===n?void 0:n.value)&&void 0!==t?t:e)},onBlur:K,className:"".concat(ce?"w-auto":"w-75"," m-1 hide-arrows ").concat(M&&"border border-danger input-has-error"),showErrorBorder:M,hideErrorMessageWrapper:!0,warning:re&&V,onKeyDown:function(e){return le(e,m,g)},focusProps:{fieldIndex:m,fieldId:g,rowIndex:h,columnId:w},onWheel:function(e){return e.currentTarget.blur()}},ie)),(M||V)&&re&&r.createElement(p.A,{content:re,className:"tooltip-icon tooltip-icon--".concat(M?"error":"warning"),icon:u.sFm}))}};return{columns:[m.accessor((function(e){var t,n;return null!=e&&null!==(t=e.binLocation)&&void 0!==t&&t.label?null==e?void 0:e.binLocation:null===(n=e.binLocation)||void 0===n?void 0:n.name}),{id:B.A.BIN_LOCATION,header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.binLocation.label","Bin Location"))}),[]),meta:{flexWidth:160,hide:!ne}}),m.accessor(B.A.LOT_NUMBER,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.lotNumber.label","Serial / Lot Number"))}),[]),meta:{flexWidth:160}}),m.accessor(B.A.EXPIRATION_DATE,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.expirationDate.label","Expiration Date"))}),[]),meta:{getCellContext:function(){return{className:"split-table-right"}},flexWidth:160}}),m.accessor(B.A.QUANTITY_COUNTED,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.quantityCounted.label","Quantity Counted"))}),[]),cell:(0,r.useCallback)((function(e){var t=e.row.original,n=t.quantityCounted,o=t.commentFromCount;return r.createElement(_.n,{className:"rt-td rt-td-count-step static-cell-count-step d-flex align-items-center"},null===n?r.createElement(k,{variant:M.EMPTY}):n,o&&r.createElement(g.Tooltip,{arrow:"true",delay:"150",duration:"250",hideDelay:"50",html:r.createElement("span",{className:"p-2"},o)},r.createElement(u.Z0O,{role:"button",size:16,className:"ml-2"})))}),[]),meta:{flexWidth:120}}),m.accessor(B.A.COUNT_DIFFERENCE,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.countDifference.label","Count Difference"))}),[]),cell:(0,r.useCallback)((function(e){var t=e.row.original,n=t.quantityVariance,o=t.quantityCounted,i=o||0===o?q(n,o):M.EMPTY;return r.createElement(_.n,{className:"rt-td rt-td-count-step static-cell-count-step d-flex align-items-center"},r.createElement(k,{value:n,variant:i,showAbsoluteValue:!0}))}),[]),meta:{flexWidth:120}}),m.accessor(B.A.QUANTITY_RECOUNTED,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.quantityRecounted.label","Quantity Recounted"))}),[]),meta:{flexWidth:120}}),m.accessor(B.A.RECOUNT_DIFFERENCE,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.recountDifference.label","Recount Difference"))}),[]),cell:function(e){var t,n=e.row,o=n.original.quantityOnHand,i=n.index,a=W((0,r.useState)(null==c||null===(t=c[i])||void 0===t?void 0:t.quantityRecounted),2),u=a[0],l=a[1],s=u-(o||0),d=q(s,u);return X.on("refreshRecountDifference",(function(){var e;l(null==c||null===(e=c[i])||void 0===e?void 0:e.quantityRecounted)})),r.createElement(_.n,{className:"rt-td rt-td-count-step static-cell-count-step d-flex align-items-center"},r.createElement(k,{value:s,variant:d,showAbsoluteValue:!0}))},meta:{flexWidth:120}}),m.accessor(B.A.ROOT_CAUSE,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.rootCause.label","Root Cause"))}),[]),meta:{flexWidth:160}}),m.accessor(B.A.COMMENT,{header:(0,r.useMemo)((function(){return r.createElement(D.A,{className:"rt-th-count-step"},G("react.cycleCount.table.comment.label","Comment"))}),[]),meta:{flexWidth:160,getCellContext:function(){return{className:"overflow-hidden"}}}}),m.accessor(null,{id:B.A.ACTIONS,header:(0,r.useMemo)((function(){return r.createElement(D.A,null)}),[]),cell:(0,r.useCallback)((function(e){var o=e.row.original;return r.createElement(_.n,{className:"rt-td d-flex justify-content-center count-step-actions"},r.createElement(g.Tooltip,{arrow:"true",delay:"150",duration:"250",hideDelay:"50",className:"text-overflow-ellipsis",html:r.createElement("span",{className:"p-2"},G("react.default.button.delete.label","Delete"))},(o.id.includes("newRow")||o.custom)&&r.createElement(u.WFf,{className:"cursor-pointer",onClick:function(){return n(t,o.id)},size:22})))}),[]),meta:{flexWidth:50,hide:!c.some((function(e){var t;return(null===(t=e.id)||void 0===t?void 0:t.includes("newRow"))||e.custom}))||!l}})],defaultColumn:ie,users:$}}({cycleCountId:n,validationErrors:j,tableData:c,removeRow:v,isStepEditable:G,shouldHaveRootCause:P,productId:null==o?void 0:o.id,addEmptyRow:d,refreshFocusCounter:K,triggerValidation:X}),J=$.columns,Z=$.defaultColumn,ee=$.users,te=(0,f.A)(),ne=y?{id:y.id,value:y.id,label:null!==(t=y.label)&&void 0!==t?t:"".concat(y.firstName," ").concat(y.lastName),name:"".concat(y.firstName," ").concat(y.lastName)}:void 0,re=(0,b.d4)((function(e){return{formatLocalizedDate:(0,z.Yq)(e.localize)}})).formatLocalizedDate,oe=function(){return null===H?null:null==y||!y.id||null};return r.createElement("div",{className:"list-page-list-section"},r.createElement("p",{className:"count-step-title pt-4 pl-4"},null==o?void 0:o.productCode," ",null==o?void 0:o.name),r.createElement("div",{className:"d-flex"},r.createElement("div",{className:"pt-3 pl-4 d-flex align-items-center"},r.createElement(C.A,{label:te("react.cycleCount.dateCounted.label","Date Counted"),value:re(i,O.o.DD_MMM_YYYY)}),r.createElement(C.A,{label:te("react.cycleCount.countedBy.label","Counted by"),value:null==h?void 0:h.name,className:"pl-4"})),r.createElement("div",{className:"ml-5 pt-3 pl-4 d-flex align-items-center"},G?r.createElement(E.A,{label:te("react.cycleCount.dateRecounted.label","Date recounted")},r.createElement(A.A,{className:"date-counted-date-picker date-field-input",onChangeRaw:I,value:a,customDateFormat:O.o.DD_MMM_YYYY,hideErrorMessageWrapper:!0})):r.createElement(C.A,{label:te("react.cycleCount.dateRecounted.label","Date recounted"),value:re(a,O.o.DD_MMM_YYYY)}),G?r.createElement(E.A,{label:te("react.cycleCount.recountedBy.label","Recounted by"),className:"ml-5"},r.createElement(p.A,{content:(null==y?void 0:y.label)||te("react.cycleCount.recountedBy.label","Recounted by"),show:!oe()},r.createElement("div",{className:"position-relative"},r.createElement(R.A,{errorMessage:oe(),placeholder:"Select",options:ee,onChange:m(n),defaultValue:ne,hideErrorMessageWrapper:!0,className:"min-width-250 ".concat(oe()&&"input-has-error")}),oe()&&r.createElement(p.A,{content:te("react.cycleCount.requiredField","This field is required"),className:"tooltip-icon tooltip-icon--error tooltip-icon--top-60",icon:u.sFm})))):r.createElement(C.A,{label:te("react.cycleCount.recountedBy.label","Recounted by"),value:null==y?void 0:y.name,className:"ml-4"}))),r.createElement("div",{className:"mx-4 count-step-table resolve-step-table"},r.createElement(w.A,{columns:J,data:c,totalCount:c.length,defaultColumn:Z,meta:s,filterParams:{},disablePagination:!0})),r.createElement("div",{className:"ml-4 mb-3 d-flex ".concat(G?"":"pt-3")},G&&r.createElement(g.Tooltip,{className:"d-flex align-items-center",html:r.createElement("span",{className:"p-1"},te("react.cycleCount.addNewRecord.tooltip","Use this button to change lot number or bin location."))},r.createElement(l.A,{onClick:function(){d(null==o?void 0:o.id,n)},label:"react.cycleCount.addNewRecord.label",defaultLabel:"Add new record",variant:"transparent",StartIcon:r.createElement(RiAddCircleLine,{size:18})}))))};const X=G;G.propTypes={id:a().string.isRequired,product:a().shape({id:a().string.isRequired,productCode:a().string.isRequired,name:a().string.isRequired}).isRequired,dateRecounted:a().string.isRequired,recountedBy:a().shape({}).isRequired,countedBy:a().shape({}).isRequired,dateCounted:a().string.isRequired,tableData:a().arrayOf(a().shape({})).isRequired,tableMeta:a().shape({updateData:a().func.isRequired}).isRequired,addEmptyRow:a().func.isRequired,removeRow:a().func.isRequired,assignRecountedBy:a().func.isRequired,validationErrors:a().shape({}).isRequired,setRecountedDate:a().func.isRequired,shouldHaveRootCause:a().func.isRequired,isStepEditable:a().bool.isRequired,isFormValid:a().bool.isRequired,refreshFocusCounter:a().number.isRequired,triggerValidation:a().func.isRequired};var K=n(95093),$=n.n(K),J=n(84976),Z=n(15095),ee=n(46857),te=n(76477),ne=n(14476),re=n(33152),oe=n(70317),ie=n(88463),ae=n(11209);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return(t=function(e){var t=function(e){if("object"!=ue(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ue(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(e,t){if(e){if("string"==typeof e)return fe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(e,t):void 0}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const ve=function(e){var t,n,o=e.tableData,i=(0,r.useRef)({}),a=(t=(0,r.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,n)||de(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],l=a[1],c=(0,r.useRef)(null),s=(0,f.A)(),d=(0,ae.A)().forceRerender,v=(0,ie.A)({tableData:o}),m=v.checkDuplicatedLotNumber,p=v.checkProductsWithLotAndExpiryControl,y=v.checkDifferentExpirationDatesForTheSameLot,h=v.checkLotNumberRequireness,b=ne.z.object({id:ne.z.string(),product:ne.z.object({productCode:ne.z.string().nullish(),lotAndExpiryControl:ne.z.boolean().nullish()}).nullish(),quantityCounted:ne.z.number({required_error:s("react.cycleCount.requiredQuantityCounted","Quantity counted is required"),invalid_type_error:s("react.cycleCount.requiredQuantityCounted","Quantity counted is required")}).gte(0).nullish(),quantityOnHand:ne.z.number().nullish(),quantityRecounted:ne.z.number({required_error:s("react.cycleCount.requiredQuantityRecounted.label","Quantity recounted is required"),invalid_type_error:s("react.cycleCount.requiredQuantityRecounted.label","Quantity recounted is required")}).gte(0),inventoryItem:ne.z.object({expirationDate:ne.z.string().optional().nullable(),lotNumber:ne.z.string().optional().nullable()}).optional(),binLocation:ne.z.object({id:ne.z.string(),name:ne.z.string(),label:ne.z.string().optional()}).nullish(),rootCause:ne.z.object({id:ne.z.string(),value:ne.z.string(),label:ne.z.string()}).nullish()}).refine(h,{path:["inventoryItem.lotNumber"],message:s("react.cycleCount.requiredLotNumber","Lot number is required")}),g=ne.z.array(b).superRefine(m).superRefine(y).superRefine(p),C=function(){return L().flatten(o.current.map((function(e){return e.cycleCountItems}))).reduce((function(e,t){var n=t.quantityRecounted-(t.quantityOnHand||0);return 0===n||Number.isNaN(n)||null===t.quantityRecounted||t.rootCause?e:[].concat(function(e){return function(e){if(Array.isArray(e))return fe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||de(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e),[null==t?void 0:t.id])}),[])};return{validationErrors:i.current,isFormValid:c.current,triggerValidation:function(){var e=o.current.reduce((function(e,t){var n,r=g.safeParse(t.cycleCountItems);return ce(ce({},e),{},se({},t.id,{errors:null==r||null===(n=r.error)||void 0===n?void 0:n.format(),success:r.success}))}),{}),t=L().every(Object.values(e),(function(e){return e.success}));return i.current=e,c.current=t,t},validateRootCauses:C,shouldHaveRootCause:function(e){var t,n=null===(t=L().flatten(o.current.map((function(e){return e.cycleCountItems}))).find((function(t){return t.id===e})))||void 0===t?void 0:t.rootCause;return C().includes(e)&&!n},showEmptyRootCauseWarning:function(){l(!0),(0,re.A)(oe.A.INFO)({message:s("react.cycleCount.popup.emptyRootCause.label","Are you sure you want to continue with empty root cause? Click next if you want to continue.")})},forceRerender:d,isRootCauseWarningSkipped:u,rowValidationSchema:b,rowsValidationSchema:g,resetValidationState:function(){i.current={},c.current=null}}};var me=n(50563),pe=n(55216);function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function he(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Ne(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function be(){be=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),u=new T(r||[]);return o(a,"_invoke",{value:N(e,n,u)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var f="suspendedStart",v="suspendedYield",m="executing",p="completed",y={};function h(){}function b(){}function g(){}var C={};c(C,a,(function(){return this}));var E=Object.getPrototypeOf,w=E&&E(E(S([])));w&&w!==n&&r.call(w,a)&&(C=w);var A=g.prototype=h.prototype=Object.create(C);function R(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,i,a,u){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,s=c.value;return s&&"object"==ye(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,a,u)}),(function(e){n("throw",e,a,u)})):t.resolve(s).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,u)}))}u(l.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function N(t,n,r){var o=f;return function(i,a){if(o===m)throw Error("Generator is already running");if(o===p){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var u=r.delegate;if(u){var l=x(u,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var c=d(t,n,r);if("normal"===c.type){if(o=r.done?p:v,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=p,r.method="throw",r.arg=c.arg)}}}function x(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function S(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(ye(t)+" is not iterable")}return b.prototype=g,o(A,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,l,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},R(O.prototype),c(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new O(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},R(A),c(A,l,"Generator"),c(A,a,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=S,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return u.type="throw",u.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:S(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function ge(e,t,n,r,o,i,a){try{var u=e[i](a),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(r,o)}function Ce(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ge(i,r,o,a,u,"next",e)}function u(e){ge(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Ee(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ne(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e,t,n){return(t=function(e){var t=function(e){if("object"!=ye(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ye(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(e,t)||Ne(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,t){if(e){if("string"==typeof e)return xe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ie=n(69641);const Le=function(){var e=function(){var e=(0,r.useRef)([]),t=Oe((0,r.useState)({}),2),n=t[0],o=t[1],i=Oe((0,r.useState)({}),2),a=i[0],u=i[1],l=Oe((0,r.useState)(!0),2),d=l[0],f=l[1],v=Oe((0,r.useState)(0),2),m=v[0],p=v[1],y=(0,me.A)(),h=y.show,g=y.hide,C=(0,J.useHistory)(),E=Oe((0,r.useState)(!1),2),w=E[0],A=E[1],R=ve({tableData:e}),N=R.validationErrors,x=R.isRootCauseWarningSkipped,I=R.triggerValidation,S=R.forceRerender,_=R.validateRootCauses,D=R.shouldHaveRootCause,j=R.showEmptyRootCauseWarning,q=R.isFormValid,M=R.resetValidationState,P=(0,b.wA)(),k=(0,b.d4)((function(e){return{users:e.users.data,cycleCountIds:e.cycleCount.cycleCounts,reasonCodes:e.cycleCount.reasonCodes,currentLocation:e.session.currentLocation}})),F=k.cycleCountIds,B=k.currentLocation,U=k.reasonCodes,Y=k.users,z=function(){p((function(e){return e+1}))},Q=(0,r.useMemo)((function(){return(0,V.Wx)(B.supportedActivities)}),[null==B?void 0:B.id]);(0,r.useEffect)((function(){Q&&P((0,T.Gg)(null==B?void 0:B.id,[te.A.RECEIVE_STOCK]))}),[null==B?void 0:B.id]);var W=function(e){var t;return e?{id:null==e?void 0:e.name,label:null==U||null===(t=U.find)||void 0===t||null===(t=t.call(U,(function(t){return(null==t?void 0:t.id)===(null==e?void 0:e.name)})))||void 0===t?void 0:t.label,value:null==e?void 0:e.name}:null},H=function(e){var t=L().groupBy(e,"custom"),n=t.false,r=t.true;if(!r)return n;var o=L().sortBy(r,"dateCreated");return[].concat(Ee(n),Ee(o))},G=function(){var t=Ce(be().mark((function t(){var n,r,i,a,l,c,s;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z.A.getCycleCounts(null==B?void 0:B.id,F);case 2:a=t.sent,l=a.data,e.current=null==l||null===(n=l.data)||void 0===n?void 0:n.map((function(e){var t,n,r=(t=e.cycleCountItems,n=L().groupBy(t,(function(e){var t,n;return"".concat(null===(t=e.binLocation)||void 0===t?void 0:t.id,"-").concat(null==e||null===(n=e.inventoryItem)||void 0===n?void 0:n.lotNumber)})),Object.values(n).flatMap((function(e){if(1===e.length){var t=e[0];return[Ae(Ae({},t),{},{quantityRecounted:null==t?void 0:t.quantityCounted,dateRecounted:null==t?void 0:t.dateCounted,recountedBy:null==t?void 0:t.assignee,quantityVariance:null,quantityCounted:null,commentFromCount:null,dateCounted:null,countedBy:null,rootCause:W(null==t?void 0:t.discrepancyReasonCode)})]}var n=L().groupBy(e,"countIndex"),r=L().maxBy(e,"countIndex").countIndex,o=L().find(e,(function(e){return e.countIndex===r-1}));return(n[r]||[]).map((function(e){return Ae(Ae(Ae({},o),e),{},{commentFromCount:null==o?void 0:o.comment,quantityRecounted:null==e?void 0:e.quantityCounted,quantityCounted:null==o?void 0:o.quantityCounted,quantityVariance:null==o?void 0:o.quantityVariance,dateCounted:null==o?void 0:o.dateCounted,dateRecounted:null==e?void 0:e.dateCounted,countedBy:null==o?void 0:o.assignee,recountedBy:null==e?void 0:e.assignee,rootCause:W(null==e?void 0:e.discrepancyReasonCode)})}))})));return Ae(Ae({},e),{},{cycleCountItems:H(r)})})),c=null===(r=e.current)||void 0===r?void 0:r.reduce((function(e,t){var n;return Ae(Ae({},e),{},Re({},null==t?void 0:t.id,null==t||null===(n=t.cycleCountItems)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.dateRecounted))}),{}),s=null===(i=e.current)||void 0===i?void 0:i.reduce((function(e,t){var n;return Ae(Ae({},e),{},Re({},null==t?void 0:t.id,null==t||null===(n=t.cycleCountItems)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.recountedBy))}),{}),u(c),o(s);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,r.useEffect)((function(){Ce(be().mark((function e(){return be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:case"end":return e.stop()}}),e)})))()}),[F]),(0,r.useEffect)((function(){null!=Y&&Y.length||P((0,T.hU)())}),[]);var X=function(){var e=Ce(be().mark((function e(t){return be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(),e.next=3,(0,pe.A)({url:(0,ee.BC)(null==B?void 0:B.id),params:{id:F},format:t});case 3:z(),g();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Ce(be().mark((function e(){var t,n,r;return be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,h(),t=he(F),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=11;break}return r=n.value,e.next=9,Z.A.refreshItems(null==B?void 0:B.id,r);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:return e.prev=19,z(),g(),e.next=24,G();case 24:return e.finish(19);case 25:case"end":return e.stop()}}),e,null,[[0,,19,25],[3,13,16,19]])})));return function(){return e.apply(this,arguments)}}(),ne=function(e){return null==n?void 0:n[e]},re=function(t,n){var r=e.current.findIndex((function(e){return(null==e?void 0:e.id)===t}));e.current=e.current.map((function(e,t){return t===r?Ae(Ae({},e),{},{cycleCountItems:e.cycleCountItems.map((function(e){return Ae(Ae({},e),{},{updated:n})}))}):e}))},oe=function(e){return re(e,!0)},ie=function(e){return a[e]},ae=function(e,t){var n,r,o,i,a;return{quantityCounted:null==e?void 0:e.quantityRecounted,countIndex:1,inventoryItem:Ae(Ae({},e.inventoryItem),{},{product:null==e||null===(n=e.product)||void 0===n?void 0:n.id,expirationDate:null===(null==e||null===(r=e.inventoryItem)||void 0===r?void 0:r.expirationDate)?null:$()(null==e||null===(o=e.inventoryItem)||void 0===o?void 0:o.expirationDate,O.o.MMM_DD_YYYY).format()}),binLocation:null==e?void 0:e.binLocation,comment:null==e?void 0:e.comment,dateCounted:ie(null==t?void 0:t.id),id:null==e?void 0:e.id,facility:null==e?void 0:e.facility,discrepancyReasonCode:null==e||null===(i=e.rootCause)||void 0===i?void 0:i.id,assignee:null===(a=ne(t.id))||void 0===a?void 0:a.id,recount:!0}},ue=function(){var t=Ce(be().mark((function t(){var n,r,o,i,a,u,l,c,s,d,f;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,h(),M(),n=he(e.current),t.prev=4,n.s();case 6:if((r=n.n()).done){t.next=47;break}o=r.value,i=o.cycleCountItems.filter((function(e){return e.updated&&!e.id.includes("newRow")})),a=he(i),t.prev=10,a.s();case 12:if((u=a.n()).done){t.next=18;break}return l=u.value,t.next=16,Z.A.updateCycleCountItem(ae(l,o),null==B?void 0:B.id,null==l?void 0:l.id);case 16:t.next=12;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(10),a.e(t.t0);case 23:return t.prev=23,a.f(),t.finish(23);case 26:c=o.cycleCountItems.filter((function(e){return e.id.includes("newRow")})),s=he(c),t.prev=28,s.s();case 30:if((d=s.n()).done){t.next=36;break}return f=d.value,t.next=34,Z.A.createCycleCountItem(ae(f,o),null==B?void 0:B.id,null==o?void 0:o.id);case 34:t.next=30;break;case 36:t.next=41;break;case 38:t.prev=38,t.t1=t.catch(28),s.e(t.t1);case 41:return t.prev=41,s.f(),t.finish(41);case 44:v=o.id,re(v,!1);case 45:t.next=6;break;case 47:t.next=52;break;case 49:t.prev=49,t.t2=t.catch(4),n.e(t.t2);case 52:return t.prev=52,n.f(),t.finish(52);case 55:return t.prev=55,t.next=58,G();case 58:return g(),z(),t.finish(55);case 61:case"end":return t.stop()}var v}),t,null,[[0,,55,61],[4,49,52,55],[10,20,23,26],[28,38,41,44]])})));return function(){return t.apply(this,arguments)}}(),le=function(){var t=Ce(be().mark((function t(){var n,r,o,i;return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,h(),t.next=4,ue();case 4:n=he(e.current),t.prev=5,n.s();case 7:if((r=n.n()).done){t.next=13;break}return i=r.value,t.next=11,Z.A.submitRecount({refreshQuantityOnHand:!0,failOnOutdatedQuantity:!0,requireRecountOnDiscrepancy:!1,cycleCountItems:null==i||null===(o=i.cycleCountItems)||void 0===o?void 0:o.map((function(e){return{assignee:null==(t=e)?void 0:t.recountedBy,binLocation:null==t?void 0:t.binLocation,comment:null==t?void 0:t.comment,countIndex:1,dateCounted:null==t?void 0:t.dateRecounted,discrepancyReasonCode:null==t?void 0:t.discrepancyReasonCode,facility:null==B?void 0:B.id,id:null==t?void 0:t.id,inventoryItem:null==t?void 0:t.inventoryItem,product:null==t?void 0:t.product,quantityCounted:null==t?void 0:t.quantityRecounted};var t}))},null==B?void 0:B.id,null==i?void 0:i.id);case 11:t.next=7;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(5),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:C.push(c.BC.list(s.v0));case 22:return t.prev=22,g(),t.finish(22);case 25:case"end":return t.stop()}}),t,null,[[0,,22,25],[5,15,18,21]])})));return function(){return t.apply(this,arguments)}}(),ce={updateData:function(t,n,r,o){!function(t,n,r,o){var i=e.current.findIndex((function(e){return(null==e?void 0:e.id)===t})),a=e.current[i].cycleCountItems.findIndex((function(e){return e.id===n})),u=r.replaceAll("_",".");L().set(e.current,"[".concat(i,"].cycleCountItems[").concat(a,"].").concat(u),o),L().set(e.current,"[".concat(i,"].cycleCountItems[").concat(a,"].updated"),!0)}(t,n,r,o)}};return{tableData:e.current,tableMeta:ce,validationErrors:N,isStepEditable:d,isFormValid:q,getRecountedBy:ne,getCountedBy:function(t){var n;return null==e||null===(n=e.current.find((function(e){return(null==e?void 0:e.id)===t})))||void 0===n||null===(n=n.cycleCountItems)||void 0===n||null===(n=n.find((function(e){return null==e?void 0:e.countedBy})))||void 0===n?void 0:n.countedBy},addEmptyRow:function(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={id:L().uniqueId("newRow"),product:{id:t},inventoryItem:{lotNumber:null,expirationDate:null},binLocation:null,quantityRecounted:null,quantityCounted:null,rootCause:null,comment:""},i=e.current.findIndex((function(e){return(null==e?void 0:e.id)===n}));e.current=e.current.map((function(e,t){return t===i?Ae(Ae({},e),{},{cycleCountItems:[].concat(Ee(e.cycleCountItems),[o])}):e})),r&&z(),M(),S()},removeRow:function(t,n){try{h(),n.includes("newRow")||Z.A.deleteCycleCountItem(null==B?void 0:B.id,n),function(t,n){var r=e.current.findIndex((function(e){return(null==e?void 0:e.id)===t}));e.current=e.current.map((function(e,t){return t===r?Ae(Ae({},e),{},{cycleCountItems:e.cycleCountItems.filter((function(e){return e.id!==n}))}):e}))}(t,n)}finally{z(),I(),g()}},printRecountForm:X,refreshCountItems:K,assignRecountedBy:function(e){return function(t){oe(e),o((function(n){return Ae(Ae({},n),{},Re({},e,t))})),z()}},getRecountedDate:ie,setRecountedDate:function(e){return function(t){u(Ae(Ae({},a),{},Re({},e,t.format()))),oe(e),z()}},shouldHaveRootCause:D,next:function(){z();var e=I();S();var t=L().every(F,(function(e){var t;return null===(t=ne(e))||void 0===t?void 0:t.id}));if(e&&t){var n=_();!x&&n.length>0?j():f(!1)}},save:ue,submitRecount:le,back:function(){f(!0),z()},getProduct:function(e){var t;return null===(t=e[0])||void 0===t?void 0:t.product},getDateCounted:function(e){var t;return null==e||null===(t=e.find((function(e){return e.dateCounted})))||void 0===t?void 0:t.dateCounted},refreshFocusCounter:m,triggerValidation:I,isSaveDisabled:w,setIsSaveDisabled:A}}(),t=e.tableData,n=e.validationErrors,i=e.printRecountForm,a=e.refreshCountItems,u=e.next,l=e.tableMeta,d=e.addEmptyRow,f=e.removeRow,v=e.assignRecountedBy,m=e.getRecountedDate,p=e.setRecountedDate,y=e.shouldHaveRootCause,g=e.back,C=e.save,E=e.isStepEditable,w=e.getRecountedBy,A=e.getCountedBy,R=e.submitRecount,N=e.getProduct,x=e.getDateCounted,I=e.isFormValid,S=e.refreshFocusCounter,_=e.triggerValidation,D=e.isSaveDisabled,j=e.setIsSaveDisabled;return r.createElement(Ie.A,null,E?r.createElement(h,{printRecountForm:i,refreshCountItems:a,next:u,save:C}):r.createElement(o.A,{back:g,save:R,isSaveDisabled:D,setIsSaveDisabled:j}),t.map((function(e){var t=e.cycleCountItems,o=e.id;return r.createElement(X,{key:o,id:o,product:N(t),dateCounted:x(t),dateRecounted:m(o),tableData:t,tableMeta:l,addEmptyRow:d,removeRow:f,setRecountedDate:p(o),assignRecountedBy:v,validationErrors:n,shouldHaveRootCause:y,isStepEditable:E,recountedBy:w(o),countedBy:A(o),isFormValid:I,triggerValidation:_,refreshFocusCounter:S})})))}}}]);
//# sourceMappingURL=bundle.929af1b45eb780bfc503.442.js.map