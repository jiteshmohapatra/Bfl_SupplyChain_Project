"use strict";(self.webpackChunkopenboxes=self.webpackChunkopenboxes||[]).push([[8901],{13266:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(76477),i=n(60532),r=n(85728);const o=function(e,t,n){var o,s,l,u=(null==e?void 0:e.id)===(null==t||null===(o=t.requestedBy)||void 0===o?void 0:o.id),d=n.id===(null==t||null===(s=t.origin)||void 0===s?void 0:s.id),c=n.id===(null==t||null===(l=t.destination)||void 0===l?void 0:l.id);return(0,r.xY)(null==n?void 0:n.supportedActivities,a.A.APPROVE_REQUEST)?[i.A.APPROVED,i.A.PACKED,i.A.PICKED,i.A.PICKING].includes(null==t?void 0:t.statusCode)?d:u&&(c||d)&&t.statusCode!==i.A.REJECTED:!!d||c&&u}},36307:(e,t,n)=>{n.d(t,{A:()=>a});const a={CREATED:"CREATED",EDITING:"EDITING",VERIFYING:"VERIFYING",PICKING:"PICKING",PICKED:"PICKED",PENDING:"PENDING",CHECKING:"CHECKING",ISSUED:"ISSUED",RECEIVED:"RECEIVED",CANCELED:"CANCELED",DELETED:"DELETED",ERROR:"ERROR",DISPATCHED:"DISPATCHED",REQUESTED:"REQUESTED",OPEN:"OPEN",FULFILLED:"FULFILLED",REVIEWING:"REVIEWING",CONFIRMING:"CONFIRMING",PENDING_APPROVAL:"PENDING_APPROVAL",APPROVED:"APPROVED",REJECTED:"REJECTED"}},60532:(e,t,n)=>{n.d(t,{A:()=>a});const a={CREATED:"CREATED",REQUESTING:"REQUESTING",REQUESTED:"REQUESTED",PENDING_APPROVAL:"PENDING_APPROVAL",VALIDATING:"VALIDATING",VALIDATED:"VALIDATED",APPROVED:"APPROVED",PICKING:"PICKING",PICKED:"PICKED",CHECKING:"CHECKING",CHECKED:"CHECKED",PACKED:"PACKED",REVIEWING:"REVIEWING",DISPATCHED:"DISPATCHED",CANCELED:"CANCELED",REJECTED:"REJECTED"}},85728:(e,t,n)=>{n.d(t,{Wx:()=>o,qu:()=>i,xY:()=>r});var a=n(76477),i=function(e,t,n){return e===t&&!n.includes(a.A.MANAGE_INVENTORY)&&n.includes(a.A.SUBMIT_REQUEST)},r=function(e,t){return null==e?void 0:e.includes(t)},o=function(e){return r(e,a.A.PUTAWAY_STOCK)&&r(e,a.A.PICK_STOCK)}},88068:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ye});var a=n(96540),i=n(5556),r=n.n(i),o=n(88600),s=n(697),l=n(8949),u=n(74167),d=n(45066),c=n(15945),f=n(924),m=n(46894),p=n.n(m),b=n(2543),v=n.n(b),y=n(23350),h=n(90952),g=n(84976),I=n(84914),E=n.n(I),q=n(51836),A=n(41640),C=n(42164),R=n(93638),P=n(45814),S=n(10734),k=n(20655),M=n(34297),O=n(98966),D=n(33274),w=n(50709),N=n(36307),T=n(43256),x=n(26438),L=n(44323),V=n(13266),U=n(88024),F=n(26216);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function W(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,$(a.key),a)}}function Q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Q=function(){return!!e})()}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}function Y(e,t,n){return(t=$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}var J={YES:"btn btn-outline-success",NO:"btn btn-outline-secondary",EARLIER:"btn btn-outline-warning",HIDDEN:"btn invisible"},X={editPageItems:{type:A.A,arrowsNavigation:!0,virtualized:!0,totalCount:function(e){return e.totalCount},isRowLoaded:function(e){return e.isRowLoaded},isFirstPageLoaded:function(e){return e.isFirstPageLoaded},loadMoreRows:function(e){return(0,e.loadMoreRows)()},rowComponent:k.A,getDynamicRowAttr:function(e){var t=e.rowValues,n=e.showOnlyErroredItems,a=e.itemFilter,i="SUBSTITUTED"===t.statusCode?"crossed-out ":"";t.quantityAvailable<t.quantityRequested&&(i+="font-weight-bold");var r=a&&!(t.product.name.toLowerCase().includes(a.toLowerCase())||t.productCode.toLowerCase().includes(a.toLowerCase()));return{className:i,hideRow:n&&!t.hasError||r}},subfieldKey:"substitutionItems",headerGroupings:{requestInformation:{label:"react.verifyRequest.requestInformation.label",defaultLabel:"Request Information",flexWidth:6.5},availability:{label:"react.verifyRequest.availability.label",defaultLabel:"Availability",flexWidth:4},edit:{label:"react.verifyRequest.edit.label",defaultLabel:"Edit",flexWidth:3.5}},fields:{productCode:{type:P.A,headerAlign:"left",flexWidth:"0.5",getDynamicAttr:function(e){return{className:e.subfield?"text-center":"text-left ml-1"}},label:"react.stockMovement.code.label",defaultMessage:"Code",attributes:{showValueTooltip:!0}},product:{type:P.A,headerAlign:"left",flexWidth:"3",label:"react.stockMovement.productName.label",defaultMessage:"Product name",attributes:{formatValue:function(e){var t,n,i;return a.createElement(q.Tooltip,{html:a.createElement("div",{className:"text-truncate"},e.name),theme:"dark",disabled:!(null!==(t=e.displayNames)&&void 0!==t&&t.default),position:"top-start"},a.createElement("span",{className:"d-flex align-items-center"},a.createElement("span",{className:"text-truncate"},null!==(n=null===(i=e.displayNames)||void 0===i?void 0:i.default)&&void 0!==n?n:e.name),(0,U.A)(e?e.handlingIcons:null)))}},getDynamicAttr:function(e){var t=e.fieldValue;return{className:e.subfield?"text-center":"text-left ml-1",color:null==t?void 0:t.color}}},quantityOnHandRequesting:{type:P.A,label:"react.stockMovement.requesterQuantityOnHand.label",defaultMessage:"Requester QOH",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityDemandRequesting:{type:P.A,label:"react.stockMovement.quantityDemand.label",defaultMessage:"Demand",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityRequested:{type:function(e){var t=e.fieldName,n=e.values,i=v().split(t,".");if(2===i.length){var r=i[0],o=v().get(n,r);if(o.comments)return a.createElement("div",{className:"d-flex align-items-center"},a.createElement("div",{style:{flex:1,marginLeft:"14px"}},a.createElement(P.A,e)),a.createElement(q.Tooltip,{html:o.comments,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement("i",{className:"fa fa-sticky-note pr-2"})))}return a.createElement(P.A,e)},label:"react.verifyRequest.quantityRequested.label",defaultMessage:"Qty Requested",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityOnHand:{type:P.A,label:"react.stockMovement.quantityOnHand.label",defaultMessage:"QOH",flexWidth:"1",fieldKey:"",headerClassName:"left-border",attributes:{formatValue:function(e){return e.quantityOnHand?e.quantityOnHand.toLocaleString("en-US"):e.quantityOnHand},numberField:!0,className:"left-border"}},quantityAvailable:{type:P.A,label:"react.stockMovement.available.label",defaultMessage:"Available",flexWidth:"1",fieldKey:"",getDynamicAttr:function(e){var t=e.fieldValue,n="";return t&&(!t.quantityAvailable||t.quantityAvailable<t.quantityRequested)&&(n+="text-danger"),{className:n}},attributes:{formatValue:function(e){return e.quantityAvailable?e.quantityAvailable.toLocaleString("en-US"):e.quantityAvailable},numberField:!0}},quantityDemandFulfilling:{type:P.A,label:"react.stockMovement.demandPerMonth.label",defaultMessage:"Demand per Month",flexWidth:"1",getDynamicAttr:function(){return{formatValue:function(e){return e&&"0"!==e?e.toLocaleString("en-US"):"0"},showValueTooltip:!0}},attributes:{numberField:!0}},detailsButton:{label:"react.stockMovement.details.label",defaultMessage:"Details",type:O.A,flexWidth:"1",fieldKey:"",attributes:{title:"react.stockMovement.pendingRequisitionDetails.label",defaultTitleMessage:"Pending Requisition Details"},getDynamicAttr:function(e){var t,n=e.fieldValue,a=e.stockMovementId,i=e.values;return{productId:n&&n.product&&n.product.id,productCode:n&&n.product&&n.product.productCode,productName:n&&n.product&&n.product.name,displayName:null==n||null===(t=n.product)||void 0===t||null===(t=t.displayNames)||void 0===t?void 0:t.default,originId:i&&i.origin&&i.origin.id,stockMovementId:a,quantityRequested:n&&n.quantityRequested,quantityOnHand:n&&n.quantityOnHand,quantityAvailable:n&&n.quantityAvailable,btnOpenText:"react.stockMovement.details.label",btnOpenDefaultText:"Details",btnCancelText:"Close",btnSaveStyle:{display:"none"},btnContainerClassName:"float-right",btnOpenAsIcon:!0,btnOpenStyle:{border:"none",cursor:"pointer"},btnOpenIcon:"fa-search"}}},substituteButton:{label:"react.stockMovement.substitution.label",defaultMessage:"Substitution",type:D.A,fieldKey:"",flexWidth:"1",headerClassName:"left-border",attributes:{cellClassName:"left-border",title:"react.stockMovement.substitutes.label",defaultTitleMessage:"Substitutes"},getDynamicAttr:function(e){var t=e.fieldValue,n=e.rowIndex,a=e.stockMovementId,i=e.onResponse,r=e.reviseRequisitionItems,o=e.values,s=e.reasonCodes,l=e.showOnly;return{onOpen:function(){return r(o)},productCode:t&&t.productCode,btnOpenText:"react.stockMovement.".concat(t&&t.substitutionStatus,".label"),btnOpenDefaultText:"".concat(t&&t.substitutionStatus),btnOpenDisabled:t&&"SUBSTITUTED"===t.statusCode||l,btnOpenClassName:J[t&&t.substitutionStatus||"HIDDEN"],rowIndex:n,lineItem:t,stockMovementId:a,onResponse:i,reasonCodes:s}}},quantityRevised:{label:"react.stockMovement.quantityRevised.label",defaultMessage:"Qty revised",type:M.A,fieldKey:"statusCode",flexWidth:"1",attributes:{type:"number"},getDynamicAttr:function(e){var t=e.fieldValue,n=e.subfield,a=e.showOnly,i=e.updateRow,r=e.values,o=e.rowIndex;return{disabled:t&&"SUBSTITUTED"===t||n||a,onBlur:function(){return i(r,o)}}}},reasonCode:{type:S.A,label:"react.stockMovement.reasonCode.label",defaultMessage:"Reason code",flexWidth:"1",fieldKey:"quantityRevised",getDynamicAttr:function(e){var t=e.fieldValue,n=e.subfield,a=e.reasonCodes,i=e.updateRow,r=e.values,o=e.rowIndex,s=e.showOnly,l=t&&"SUBSTITUTED"===t.statusCode;return{disabled:null==t||n||l||s,options:a,showValueTooltip:!0,onBlur:function(){return i(r,o)}}}},revert:{type:R.A,label:"react.default.button.undo.label",defaultMessage:"Undo",flexWidth:"0.5",fieldKey:"",buttonLabel:"react.default.button.undo.label",buttonDefaultMessage:"Undo",getDynamicAttr:function(e){var t=e.fieldValue,n=e.revertItem,a=e.values,i=e.showOnly;return{onClick:t&&t.requisitionItemId?function(){return n(a,t.requisitionItemId)}:function(){return null},hidden:!(!t||!t.statusCode||v().includes(["CHANGED","CANCELED"],t.statusCode)),disabled:i}},attributes:{className:"btn btn-outline-danger"}}}}},Z={editPageItems:{type:A.A,arrowsNavigation:!0,virtualized:!0,totalCount:function(e){return e.totalCount},isRowLoaded:function(e){return e.isRowLoaded},isFirstPageLoaded:function(e){return e.isFirstPageLoaded},loadMoreRows:function(e){return(0,e.loadMoreRows)()},rowComponent:k.A,getDynamicRowAttr:function(e){var t=e.rowValues,n=e.showOnlyErroredItems,a=e.itemFilter,i="SUBSTITUTED"===t.statusCode?"crossed-out ":"";t.quantityAvailable<t.quantityRequested&&(i+="font-weight-bold");var r=a&&!(t.product.name.toLowerCase().includes(a.toLowerCase())||t.productCode.toLowerCase().includes(a.toLowerCase()));return{className:i,hideRow:n&&!t.hasError||r}},subfieldKey:"substitutionItems",headerGroupings:{requestInformation:{label:"react.verifyRequest.requestInformation.label",defaultLabel:"Request Information",flexWidth:6.5},availability:{label:"react.verifyRequest.availability.label",defaultLabel:"Availability",flexWidth:4},edit:{label:"react.verifyRequest.edit.label",defaultLabel:"Edit",flexWidth:3.5}},fields:{productCode:{type:P.A,headerAlign:"left",flexWidth:"0.5",getDynamicAttr:function(e){return{className:e.subfield?"text-center":"text-left ml-1"}},label:"react.stockMovement.code.label",defaultMessage:"Code",attributes:{showValueTooltip:!0}},product:{type:P.A,headerAlign:"left",flexWidth:"3",label:"react.stockMovement.productName.label",defaultMessage:"Product name",attributes:{formatValue:L.OL},getDynamicAttr:function(e){var t,n=e.subfield,a=e.fieldValue;return{className:n?"text-center":"text-left ml-1",showValueTooltip:!(null==a||null===(t=a.displayNames)||void 0===t||!t.default),tooltipValue:null==a?void 0:a.name,color:null==a?void 0:a.color}}},quantityOnStocklist:{type:P.A,label:"react.stockMovement.quantityOnStocklist.label",defaultMessage:"Stocklist QTY",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityOnHandRequesting:{type:P.A,label:"react.stockMovement.requesterQuantityOnHand.label",defaultMessage:"Requester QOH",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityRequested:{type:function(e){var t=e.fieldName,n=e.values,i=v().split(t,".");if(2===i.length){var r=i[0],o=v().get(n,r);if(o.comments)return a.createElement("div",{className:"d-flex align-items-center"},a.createElement("div",{style:{flex:1,marginLeft:"14px"}},a.createElement(P.A,e)),a.createElement(q.Tooltip,{html:o.comments,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement("i",{className:"fa fa-sticky-note pr-2"})))}return a.createElement(P.A,e)},label:"react.verifyRequest.quantityRequested.label",defaultMessage:"Qty Requested",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityOnHand:{type:P.A,label:"react.stockMovement.quantityOnHand.label",defaultMessage:"QOH",flexWidth:"1",fieldKey:"",headerClassName:"left-border",attributes:{formatValue:function(e){return e.quantityOnHand?e.quantityOnHand.toLocaleString("en-US"):e.quantityOnHand},numberField:!0,className:"left-border"}},quantityAvailable:{type:P.A,label:"react.stockMovement.available.label",defaultMessage:"Available",flexWidth:"1",fieldKey:"",getDynamicAttr:function(e){var t=e.fieldValue,n="";return t&&(!t.quantityAvailable||t.quantityAvailable<t.quantityRequested)&&(n+="text-danger"),{className:n}},attributes:{formatValue:function(e){return e.quantityAvailable?e.quantityAvailable.toLocaleString("en-US"):e.quantityAvailable},numberField:!0}},quantityDemandFulfilling:{type:P.A,label:"react.stockMovement.demandPerMonth.label",defaultMessage:"Demand per Month",flexWidth:"1",getDynamicAttr:function(){return{formatValue:function(e){return e&&"0"!==e?e.toLocaleString("en-US"):"0"},showValueTooltip:!0}},attributes:{numberField:!0}},detailsButton:{label:"react.stockMovement.details.label",defaultMessage:"Details",type:O.A,flexWidth:"1",fieldKey:"",attributes:{title:"react.stockMovement.pendingRequisitionDetails.label",defaultTitleMessage:"Pending Requisition Details"},getDynamicAttr:function(e){var t,n=e.fieldValue,a=e.stockMovementId,i=e.values;return{productId:n&&n.product&&n.product.id,productCode:n&&n.product&&n.product.productCode,productName:n&&n.product&&n.product.name,displayName:null==n||null===(t=n.product)||void 0===t||null===(t=t.displayNames)||void 0===t?void 0:t.default,originId:i&&i.origin&&i.origin.id,stockMovementId:a,quantityRequested:n&&n.quantityRequested,quantityOnHand:n&&n.quantityOnHand,quantityAvailable:n&&n.quantityAvailable,btnOpenText:"react.stockMovement.details.label",btnOpenDefaultText:"Details",btnCancelText:"Close",btnSaveStyle:{display:"none"},btnContainerClassName:"float-right",btnOpenAsIcon:!0,btnOpenStyle:{border:"none",cursor:"pointer"},btnOpenIcon:"fa-search"}}},substituteButton:{label:"react.stockMovement.substitution.label",defaultMessage:"Substitution",type:D.A,fieldKey:"",flexWidth:"1",headerClassName:"left-border",attributes:{cellClassName:"left-border",title:"react.stockMovement.substitutes.label",defaultTitleMessage:"Substitutes"},getDynamicAttr:function(e){var t=e.fieldValue,n=e.rowIndex,a=e.stockMovementId,i=e.onResponse,r=e.reviseRequisitionItems,o=e.values,s=e.reasonCodes,l=e.showOnly;return{onOpen:function(){return r(o)},productCode:t&&t.productCode,btnOpenText:"react.stockMovement.".concat(t&&t.substitutionStatus,".label"),btnOpenDefaultText:"".concat(t&&t.substitutionStatus),btnOpenDisabled:t&&"SUBSTITUTED"===t.statusCode||l,btnOpenClassName:J[t&&t.substitutionStatus||"HIDDEN"],rowIndex:n,lineItem:t,stockMovementId:a,onResponse:i,reasonCodes:s}}},quantityRevised:{label:"react.stockMovement.quantityRevised.label",defaultMessage:"Qty revised",type:M.A,fieldKey:"statusCode",flexWidth:"1",attributes:{type:"number"},getDynamicAttr:function(e){var t=e.fieldValue,n=e.subfield,a=e.showOnly,i=e.updateRow,r=e.values,o=e.rowIndex;return{disabled:t&&"SUBSTITUTED"===t||n||a,onBlur:function(){return i(r,o)}}}},reasonCode:{type:S.A,label:"react.stockMovement.reasonCode.label",defaultMessage:"Reason code",flexWidth:"1",fieldKey:"quantityRevised",getDynamicAttr:function(e){var t=e.fieldValue,n=e.subfield,a=e.reasonCodes,i=e.updateRow,r=e.values,o=e.rowIndex,s=e.showOnly,l=t&&"SUBSTITUTED"===t.statusCode;return{disabled:null==t||n||l||s,options:a,showValueTooltip:!0,onBlur:function(){return i(r,o)}}}},revert:{type:R.A,label:"react.default.button.undo.label",defaultMessage:"Undo",flexWidth:"0.5",fieldKey:"",buttonLabel:"react.default.button.undo.label",buttonDefaultMessage:"Undo",getDynamicAttr:function(e){var t=e.fieldValue,n=e.revertItem,a=e.values,i=e.showOnly;return{onClick:t&&t.requisitionItemId?function(){return n(a,t.requisitionItemId)}:function(){return null},hidden:!(!t||!t.statusCode||v().includes(["CHANGED","CANCELED"],t.statusCode)),disabled:i}},attributes:{className:"btn btn-outline-danger"}}}}},ee={editPageItems:{type:A.A,arrowsNavigation:!0,virtualized:!0,totalCount:function(e){return e.totalCount},isRowLoaded:function(e){return e.isRowLoaded},isFirstPageLoaded:function(e){return e.isFirstPageLoaded},loadMoreRows:function(e){return(0,e.loadMoreRows)()},rowComponent:k.A,getDynamicRowAttr:function(e){var t=e.rowValues,n=e.showOnlyErroredItems,a=e.itemFilter,i="SUBSTITUTED"===t.statusCode?"crossed-out ":"";t.quantityAvailable<t.quantityRequested&&(i+="font-weight-bold");var r=a&&!(t.product.name.toLowerCase().includes(a.toLowerCase())||t.productCode.toLowerCase().includes(a.toLowerCase()));return{className:i,hideRow:n&&!t.hasError||r}},subfieldKey:"substitutionItems",headerGroupings:{requestInformation:{label:"react.verifyRequest.requestInformation.label",defaultLabel:"Request Information",flexWidth:7},availability:{label:"react.verifyRequest.availability.label",defaultLabel:"Availability",flexWidth:4},edit:{label:"react.verifyRequest.edit.label",defaultLabel:"Edit",flexWidth:4}},fields:{productCode:{type:P.A,headerAlign:"left",flexWidth:"0.5",getDynamicAttr:function(e){return{className:e.subfield?"text-center":"text-left ml-1"}},label:"react.stockMovement.code.label",defaultMessage:"Code",attributes:{showValueTooltip:!0}},product:{type:P.A,headerAlign:"left",flexWidth:"3.5",label:"react.stockMovement.productName.label",defaultMessage:"Product name",attributes:{formatValue:L.OL},getDynamicAttr:function(e){var t,n=e.subfield,a=e.fieldValue;return{className:n?"text-center":"text-left ml-1",showValueTooltip:!(null==a||null===(t=a.displayNames)||void 0===t||!t.default),tooltipValue:null==a?void 0:a.name,color:null==a?void 0:a.color}}},demandPerReplenishmentPeriod:{type:P.A,label:"react.stockMovement.demandPerReplenishmentPeriod.label",defaultMessage:"Demand per Replenishment Period",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityOnHandRequesting:{type:P.A,label:"react.stockMovement.requesterQuantityOnHand.label",defaultMessage:"Requester QOH",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityRequested:{type:function(e){var t=e.fieldName,n=e.values,i=v().split(t,".");if(2===i.length){var r=i[0],o=v().get(n,r);if(o.comments)return a.createElement("div",{className:"d-flex align-items-center"},a.createElement("div",{style:{flex:1,marginLeft:"14px"}},a.createElement(P.A,e)),a.createElement(q.Tooltip,{html:o.comments,theme:"transparent",delay:"150",duration:"250",hideDelay:"50"},a.createElement("i",{className:"fa fa-sticky-note pr-2"})))}return a.createElement(P.A,e)},label:"react.verifyRequest.quantityRequested.label",defaultMessage:"Qty Requested",flexWidth:"1",attributes:{formatValue:function(e){return e?e.toLocaleString("en-US"):e},numberField:!0}},quantityOnHand:{type:P.A,label:"react.stockMovement.quantityOnHand.label",defaultMessage:"QOH",flexWidth:"1",fieldKey:"",headerClassName:"left-border",attributes:{formatValue:function(e){return e.quantityOnHand?e.quantityOnHand.toLocaleString("en-US"):e.quantityOnHand},numberField:!0,className:"left-border"}},quantityAvailable:{type:P.A,label:"react.stockMovement.available.label",defaultMessage:"Available",flexWidth:"1",fieldKey:"",getDynamicAttr:function(e){var t=e.fieldValue,n="";return t&&(!t.quantityAvailable||t.quantityAvailable<t.quantityRequested)&&(n+="text-danger"),{className:n}},attributes:{formatValue:function(e){return e.quantityAvailable?e.quantityAvailable.toLocaleString("en-US"):e.quantityAvailable},numberField:!0}},quantityDemandFulfilling:{type:P.A,label:"react.stockMovement.demandPerMonth.labe",defaultMessage:"Demand per Month",flexWidth:"1",getDynamicAttr:function(){return{formatValue:function(e){return e&&"0"!==e?e.toLocaleString("en-US"):"0"},showValueTooltip:!0}},attributes:{numberField:!0}},detailsButton:{label:"react.stockMovement.details.label",defaultMessage:"Details",type:O.A,fieldKey:"",flexWidth:"1",attributes:{title:"react.stockMovement.pendingRequisitionDetails.label",defaultTitleMessage:"Pending Requisition Details"},getDynamicAttr:function(e){var t,n=e.fieldValue,a=e.stockMovementId,i=e.values;return{productId:n&&n.product&&n.product.id,productCode:n&&n.product&&n.product.productCode,productName:n&&n.product&&n.product.name,displayName:null==n||null===(t=n.product)||void 0===t||null===(t=t.displayNames)||void 0===t?void 0:t.default,originId:i&&i.origin&&i.origin.id,stockMovementId:a,quantityRequested:n&&n.quantityRequested,quantityOnHand:n&&n.quantityOnHand,quantityAvailable:n&&n.quantityAvailable,btnOpenText:"react.stockMovement.details.label",btnOpenDefaultText:"Details",btnCancelText:"Close",btnSaveStyle:{display:"none"},btnContainerClassName:"float-right",btnOpenAsIcon:!0,btnOpenStyle:{border:"none",cursor:"pointer"},btnOpenIcon:"fa-search"}}},substituteButton:{label:"react.stockMovement.substitution.label",defaultMessage:"Substitution",type:D.A,fieldKey:"",flexWidth:"1",headerClassName:"left-border",attributes:{cellClassName:"left-border",title:"react.stockMovement.substitutes.label",defaultTitleMessage:"Substitutes"},getDynamicAttr:function(e){var t=e.fieldValue,n=e.rowIndex,a=e.stockMovementId,i=e.onResponse,r=e.reviseRequisitionItems,o=e.values,s=e.reasonCodes,l=e.showOnly;return{onOpen:function(){return r(o)},productCode:t&&t.productCode,btnOpenText:"react.stockMovement.".concat(t&&t.substitutionStatus,".label"),btnOpenDefaultText:"".concat(t&&t.substitutionStatus),btnOpenDisabled:t&&"SUBSTITUTED"===t.statusCode||l,btnOpenClassName:J[t&&t.substitutionStatus||"HIDDEN"],rowIndex:n,lineItem:t,stockMovementId:a,onResponse:i,reasonCodes:s}}},quantityRevised:{label:"react.stockMovement.quantityRevised.label",defaultMessage:"Qty revised",type:M.A,fieldKey:"statusCode",flexWidth:"1",attributes:{type:"number"},getDynamicAttr:function(e){var t=e.fieldValue,n=e.subfield,a=e.showOnly,i=e.updateRow,r=e.values,o=e.rowIndex;return{disabled:t&&"SUBSTITUTED"===t||n||a,onBlur:function(){return i(r,o)}}}},reasonCode:{type:S.A,label:"react.stockMovement.reasonCode.label",defaultMessage:"Reason code",flexWidth:"1.5",fieldKey:"quantityRevised",getDynamicAttr:function(e){var t=e.fieldValue,n=e.subfield,a=e.reasonCodes,i=e.updateRow,r=e.values,o=e.rowIndex,s=e.showOnly,l=t&&"SUBSTITUTED"===t.statusCode;return{disabled:null==t||n||l||s,options:a,showValueTooltip:!0,onBlur:function(){return i(r,o)}}}},revert:{type:R.A,label:"react.default.button.undo.label",defaultMessage:"Undo",flexWidth:"0.5",fieldKey:"",buttonLabel:"react.default.button.undo.label",buttonDefaultMessage:"Undo",getDynamicAttr:function(e){var t=e.fieldValue,n=e.revertItem,a=e.values,i=e.showOnly;return{onClick:t&&t.requisitionItemId?function(){return n(a,t.requisitionItemId)}:function(){return null},hidden:!(!t||!t.statusCode||v().includes(["CHANGED","CANCELED"],t.statusCode)),disabled:i}},attributes:{className:"btn btn-outline-danger"}}}}};function te(e){var t={editPageItems:[]};return v().forEach(e.editPageItems,(function(e,n){!v().isEmpty(e.quantityRevised)&&v().isEmpty(e.reasonCode)?t.editPageItems[n]={reasonCode:"react.stockMovement.errors.reasonCodeRequired.label"}:v().isNil(e.quantityRevised)&&!v().isEmpty(e.reasonCode)&&"SUBSTITUTED"!==e.statusCode&&(t.editPageItems[n]={quantityRevised:"react.stockMovement.errors.revisedQuantityRequired.label"}),parseInt(e.quantityRevised,10)===e.quantityRequested&&(t.editPageItems[n]={quantityRevised:"react.stockMovement.errors.sameRevisedQty.label"}),!v().isEmpty(e.quantityRevised)&&e.quantityAvailable>=0&&e.quantityRevised>e.quantityAvailable&&(t.editPageItems[n]={quantityRevised:"react.stockMovement.errors.higherQty.label"}),!v().isEmpty(e.quantityRevised)&&e.quantityRevised<0&&(t.editPageItems[n]={quantityRevised:"react.stockMovement.errors.negativeQty.label"})})),t}var ne=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Y(n=function(e,t,n){return t=_(t),function(e,t){if(t&&("object"==H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Q()?Reflect.construct(t,n||[],_(e).constructor):t.apply(e,n))}(this,t,[e]),"dataFetched",!1),n.state={statusCode:"",revisedItems:[],values:G(G({},n.props.initialValues),{},{editPageItems:[]}),hasItemsLoaded:!1,totalCount:0,isFirstPageLoaded:!1,showOnlyErroredItems:!1,itemFilter:""},n.revertItem=n.revertItem.bind(n),n.fetchEditPageItems=n.fetchEditPageItems.bind(n),n.reviseRequisitionItems=n.reviseRequisitionItems.bind(n),n.isRowLoaded=n.isRowLoaded.bind(n),n.loadMoreRows=n.loadMoreRows.bind(n),n.updateRow=n.updateRow.bind(n),n.markErroredLines=n.markErroredLines.bind(n),n.validate=n.validate.bind(n),n.props.showSpinner(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),n=t,(i=[{key:"componentDidMount",value:function(){this.props.stockMovementTranslationsFetched&&(this.dataFetched=!0,this.fetchAllData(!1))}},{key:"componentWillReceiveProps",value:function(e){e.stockMovementTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchAllData(!1)),e.currentLocale!==this.props.currentLocale&&this.props.fetchReasonCodes()}},{key:"setEditPageItems",value:function(e,t){var n=this;this.props.showSpinner();var a=e.data.data,i=v().map(a,(function(e){return G(G({},e),{},{disabled:!0,quantityOnHand:e.quantityOnHand>0?e.quantityOnHand:0,quantityAvailable:e.quantityAvailable>0?e.quantityAvailable:0,quantityOnHandRequesting:e.quantityCounted,product:G(G({},e.product),{},{label:"".concat(e.productCode," ").concat(e.productName)}),reasonCode:v().find(n.props.reasonCodes,(function(t){var n=t.value;return v().includes(e.reasonCode,n)})),substitutionItems:v().map(e.substitutionItems,(function(t){return G(G({},t),{},{requisitionItemId:e.requisitionItemId,product:G(G({},t.product),{},{label:"".concat(t.productCode," ").concat(t.productName)}),reasonCode:v().find(n.props.reasonCodes,(function(t){var n=t.value;return v().includes(e.reasonCode,n)}))})}))})}));this.setState((function(e){return{revisedItems:v().filter(i,(function(e){return"CHANGED"===e.statusCode})),values:G(G({},e.values),{},{editPageItems:v().uniqBy(v().concat(e.values.editPageItems,i),"requisitionItemId")}),hasItemsLoaded:e.hasItemsLoaded||e.totalCount===v().uniqBy(v().concat(e.values.editPageItems,i),"requisitionItemId").length}}),(function(){v().isNull(t)||n.state.values.editPageItems.length===n.state.totalCount||n.loadMoreRows({startIndex:t+n.props.pageSize}),n.props.hideSpinner()}))}},{key:"getFields",value:function(){return v().get(this.state.values.stocklist,"id")?"PULL"===v().get(this.state.values.replenishmentType,"name")?ee:Z:X}},{key:"validate",value:function(e){var t=te(e);return v().forEach(e.editPageItems,(function(e,n){v().isNil(e.quantityRevised)&&e.quantityRequested>e.quantityAvailable&&"SUBSTITUTED"!==e.statusCode&&(t.editPageItems[n]={quantityRevised:"react.stockMovement.errors.lowerQty.label"})})),this.markErroredLines(e,t),t}},{key:"markErroredLines",value:function(e,t){var n=e;v().forEach(this.state.values.editPageItems,(function(e,a){n=p()(n,{editPageItems:Y({},a,{hasError:{$set:!!v().find(t.editPageItems,(function(e,t){return a===t}))}})})})),this.setState((function(e){return{values:n,showOnlyErroredItems:!!t.editPageItems.length&&e.showOnlyErroredItems}}))}},{key:"fetchAllData",value:function(e){var t=this;this.props.showSpinner(),this.props.fetchReasonCodes(),this.fetchEditPageData().then((function(n){var a=n.data.data,i=a.statusCode,r=a.associations,o=n.data.totalCount;t.setState((function(e){return{statusCode:i,totalCount:o,values:G(G({},e.values),{},{associations:r})}}),(function(){t.props.isPaginated&&!e||t.fetchItems()}))})).catch((function(){t.props.hideSpinner()}))}},{key:"fetchItems",value:function(){var e=this,t="/api/stockMovements/".concat(this.state.values.stockMovementId,"/stockMovementItems?stepNumber=3");T.Ay.get(t).then((function(t){e.setEditPageItems(t,null),e.setState({hasItemsLoaded:!0})}))}},{key:"fetchEditPageItems",value:function(){var e=this,t="/api/stockMovements/".concat(this.state.values.stockMovementId,"/stockMovementItems?stepNumber=3");T.Ay.get(t).then((function(t){var n=t.data.data;e.setState((function(t){return{hasItemsLoaded:!0,values:G(G({},t.values),{},{associations:null==n?void 0:n.associations,editPageItems:v().map(n,(function(t){return G(G({},t),{},{quantityOnHandRequesting:t.quantityCounted,quantityOnHand:t.quantityOnHand||0,reasonCode:v().find(e.props.reasonCodes,(function(e){var n=e.value;return v().includes(t.reasonCode,n)})),substitutionItems:v().map(t.substitutionItems,(function(n){return G(G({},n),{},{requisitionItemId:t.requisitionItemId,reasonCode:v().find(e.props.reasonCodes,(function(e){var n=e.value;return v().includes(t.reasonCode,n)}))})}))})}))})}}),(function(){e.fetchAllData(!1),e.props.hideSpinner()}))})).catch((function(){e.props.hideSpinner()}))}},{key:"loadMoreRows",value:function(e){var t=this,n=e.startIndex;if(this.state.totalCount){this.setState({isFirstPageLoaded:!0});var a="/api/stockMovements/".concat(this.state.values.stockMovementId,"/stockMovementItems?offset=").concat(n,"&max=").concat(this.props.pageSize,"&stepNumber=3");T.Ay.get(a).then((function(e){t.setEditPageItems(e,n)}))}}},{key:"isRowLoaded",value:function(e){var t=e.index;return!!this.state.values.editPageItems[t]}},{key:"reviseRequisitionItems",value:function(e){var t=this,n=v().filter(e.editPageItems,(function(e){if(e.quantityRevised&&e.reasonCode){var n=v().find(t.state.revisedItems,(function(t){return t.requisitionItemId===e.requisitionItemId}));return!!v().isEmpty(n)||v().toInteger(n.quantityRevised)!==v().toInteger(e.quantityRevised)||n.reasonCode!==e.reasonCode}return!1})),a=e;v().forEach(n,(function(e){var n=v().findIndex(t.state.values.editPageItems,(function(t){return e.requisitionItemId===t.requisitionItemId}));a=p()(a,{editPageItems:Y({},n,{statusCode:{$set:"CHANGED"}})})})),this.setState({values:a});var i="/api/stockMovements/".concat(this.state.values.stockMovementId,"/reviseItems"),r={lineItems:v().map(n,(function(e){return{id:e.requisitionItemId,quantityRevised:e.quantityRevised,reasonCode:e.reasonCode.value}}))};return r.lineItems.length?T.Ay.post(i,r):Promise.resolve()}},{key:"updateRow",value:function(e,t){var n,a=e.editPageItems[t];n=p()(e,{editPageItems:Y({},t,{$set:a})}),this.setState({values:n})}},{key:"save",value:function(e){var t=this;this.props.showSpinner();var n=te(e).editPageItems;return n.length?((0,L.aA)({translate:this.props.translate,errors:n}),this.props.hideSpinner(),null):this.reviseRequisitionItems(e).then((function(e){var n=JSON.parse(e.config.data);if(n.lineItems&&n.lineItems.length){var a=n.lineItems.map((function(e){return e.id})),i=n.lineItems.map((function(e){return G(G({},e),{},{requisitionItemId:e.id,reasonCode:v().find(t.props.reasonCodes,(function(t){var n=t.value;return v().includes(e.reasonCode,n)}))})})),r=v().filter(t.state.values.editPageItems,(function(e){return a.indexOf(e.requisitionItemId)<0}));t.setState({revisedItems:[].concat(W(r),W(i))})}t.props.hideSpinner(),E().success(t.props.translate("react.stockMovement.alert.saveSuccess.label","Changes saved successfully"),{timeout:3e3})})).catch((function(){return t.props.hideSpinner()}))}},{key:"refresh",value:function(){var e=this;(0,y.ZX)({title:this.props.translate("react.stockMovement.message.confirmRefresh.label","Confirm refresh"),message:this.props.translate("react.stockMovement.confirmRefresh.message","Are you sure you want to refresh? Your progress since last save will be lost."),buttons:[{label:this.props.translate("react.default.yes.label","Yes"),onClick:function(){e.setState({revisedItems:[],values:G(G({},e.props.initialValues),{},{editPageItems:[]}),hasItemsLoaded:!1,totalCount:0,isFirstPageLoaded:!1}),e.fetchAllData(!0)}},{label:this.props.translate("react.default.no.label","No")}]})}},{key:"transitionToNextStep",value:function(){var e="/api/stockMovements/".concat(this.state.values.stockMovementId,"/status"),t={status:"PICKING",createPicklist:"REQUESTED"===this.state.statusCode?"true":"false"};return T.Ay.post(e,t)}},{key:"fetchEditPageData",value:function(){var e="/api/stockMovements/".concat(this.state.values.stockMovementId);return T.Ay.get(e).then((function(e){return e})).catch((function(e){return e}))}},{key:"nextPage",value:function(e){var t=this;this.props.showSpinner(),this.reviseRequisitionItems(e).then((function(){t.transitionToNextStep().then((function(){return t.props.nextPage(e)})).catch((function(){return t.props.hideSpinner()}))})).catch((function(){return t.props.hideSpinner()}))}},{key:"updateEditPageItem",value:function(e,t){var n=v().findIndex(this.state.values.editPageItems,(function(e){return e.requisitionItemId===t.requisitionItemId})),a=v().findIndex(this.state.revisedItems,(function(e){return e.requisitionItemId===t.requisitionItemId}));this.setState((function(i){return{values:G(G({},e),{},{editPageItems:p()(e.editPageItems,Y({},n,{$set:G(G(G({},e.editPageItems[n]),t),{},{quantityOnHandRequesting:t.quantityCounted,quantityOnHand:t.quantityOnHand||0,quantityAvailable:t.quantityAvailable||0,substitutionItems:v().map(t.substitutionItems,(function(e){return G(G({},e),{},{requisitionItemId:t.requisitionItemId})}))})}))}),revisedItems:p()(i.revisedItems,a>-1?{$splice:[[a,1]]}:{})}}))}},{key:"saveAndExit",value:function(e){te(e).editPageItems.length?((0,y.ZX)({title:this.props.translate("react.stockMovement.confirmExit.label","Confirm save"),message:this.props.translate("react.stockMovement.confirmExit.message","Validation errors occurred. Are you sure you want to exit and lose unsaved data?"),buttons:[{label:this.props.translate("react.default.yes.label","Yes"),onClick:function(){window.location=w.ti.show(e.stockMovementId)}},{label:this.props.translate("react.default.no.label","No")}]}),this.props.hideSpinner()):this.reviseRequisitionItems(e).then((function(){window.location=w.ti.show(e.stockMovementId)}))}},{key:"revertItem",value:function(e,t){var n=this;this.props.showSpinner();var a="/api/stockMovementItems/".concat(t,"/revertItem"),i="/api/stockMovementItems/".concat(t,"?stepNumber=3");return T.Ay.post(a).then((function(){return T.Ay.get(i).then((function(t){var a=t.data.data;n.updateEditPageItem(e,a),n.props.hideSpinner()})).catch((function(){return n.props.hideSpinner(),Promise.reject(new Error(n.props.translate("react.stockMovement.error.revertRequisitionItem.label","Could not revert requisition items")))}))})).catch((function(){return n.props.hideSpinner(),Promise.reject(new Error(n.props.translate("react.stockMovement.error.revertRequisitionItem.label","Could not revert requisition items")))}))}},{key:"isAddingItemsAllowed",value:function(){var e,t=this.props,n=t.currentUser,a=t.currentLocation,i=this.state.values,r=null==i||null===(e=i.associations)||void 0===e||null===(e=e.requisition)||void 0===e?void 0:e.status,o=[N.A.CREATED,N.A.EDITING,N.A.VERIFYING,N.A.PENDING_APPROVAL];return(0,V.A)(n,i,a)&&o.includes(r)}},{key:"render",value:function(){var e=this,t=this.state,n=t.showOnlyErroredItems,i=t.itemFilter,r=this.props.showOnly,o=this.isAddingItemsAllowed(),s=this.state.values&&this.state.values.editPageItems.length>0?v().filter(this.state.values.editPageItems,(function(e){return e.hasError})).length:"0";return a.createElement(h.lV,{onSubmit:function(){},validate:this.validate,mutators:G({},f.A),initialValues:this.state.values,render:function(t){var l=t.handleSubmit,u=t.values,d=t.invalid;return a.createElement("div",{className:"d-flex flex-column"},r?a.createElement("button",{type:"button",onClick:function(){!e.props.supportedActivities.includes("MANAGE_INVENTORY")&&e.props.supportedActivities.includes("SUBMIT_REQUEST")?e.props.history.push(w.$h.base):e.props.history.push(w.ti.listInbound())},className:"float-right mb-1 btn btn-outline-danger align-self-end btn-xs mr-2"},a.createElement("span",null,a.createElement("i",{className:"fa fa-sign-out pr-2"})," ",a.createElement(F.A,{id:"react.default.button.exit.label",defaultMessage:"Exit"})," ")):a.createElement("span",{className:"buttons-container"},a.createElement("div",{className:"d-flex mr-auto justify-content-center align-items-center"},a.createElement("input",{value:i,onChange:function(t){return e.setState({itemFilter:t.target.value})},className:"float-left btn btn-outline-secondary btn-xs filter-input mr-1 mb-1",placeholder:e.props.translate("react.stockMovement.searchPlaceholder.label","Search...")}),i&&a.createElement("i",{"aria-label":"Clear filter",role:"button",className:"fa fa-times-circle",style:{color:"grey",cursor:"pointer"},onClick:function(){return e.setState({itemFilter:""})},onKeyPress:function(){return e.setState({itemFilter:""})},tabIndex:0})),a.createElement("button",{type:"button",onClick:function(){return e.setState({showOnlyErroredItems:!n})},className:"float-right mb-1 btn btn-outline-secondary align-self-end ml-3 btn-xs ".concat(n?"active":"")},a.createElement("span",null,s," ",a.createElement(F.A,{id:"react.stockMovement.erroredItemsCount.label",defaultMessage:"item(s) require your attention"}))),a.createElement("button",{type:"button",onClick:function(){return e.refresh()},className:"float-right mb-1 btn btn-outline-secondary align-self-end ml-3 btn-xs"},a.createElement("span",null,a.createElement("i",{className:"fa fa-refresh pr-2"}),a.createElement(F.A,{id:"react.default.button.refresh.label",defaultMessage:"Reload"}))),a.createElement("button",{type:"button",onClick:function(){return e.save(u)},className:"float-right mb-1 btn btn-outline-secondary align-self-end ml-3 btn-xs"},a.createElement("span",null,a.createElement("i",{className:"fa fa-save pr-2"}),a.createElement(F.A,{id:"react.default.button.saveProgress.label",defaultMessage:"Save Progress"}))),a.createElement("button",{type:"button",onClick:function(){return e.saveAndExit(u)},className:"float-right mb-1 btn btn-outline-secondary align-self-end btn-xs"},a.createElement("span",null,a.createElement("i",{className:"fa fa-sign-out pr-2"}),a.createElement(F.A,{id:"react.default.button.saveAndExit.label",defaultMessage:"Save and exit"})))),a.createElement("form",{onSubmit:l},a.createElement("div",{className:"table-form"},v().map(e.getFields(),(function(t,a){return(0,x.bl)(t,a,{stockMovementId:u.stockMovementId,hasStockList:!!v().get(u.stocklist,"id"),translate:e.props.translate,reasonCodes:e.props.reasonCodes,onResponse:e.fetchEditPageItems,revertItem:e.revertItem,reviseRequisitionItems:e.reviseRequisitionItems,totalCount:e.state.totalCount,loadMoreRows:e.loadMoreRows,isRowLoaded:e.isRowLoaded,isPaginated:e.props.isPaginated,updateRow:e.updateRow,isFirstPageLoaded:e.state.isFirstPageLoaded,values:u,showOnly:r,showOnlyErroredItems:n,itemFilter:i})}))),a.createElement("div",{className:"submit-buttons ".concat(o?"d-flex justify-content-between":"")},o&&a.createElement(C.A,{label:"react.stockMovement.editRequestItems.label",defaultLabel:"Edit request items",variant:"primary-outline",onClick:function(){var t;e.props.history.push(w.ti.editRequest(null===(t=e.state.values)||void 0===t?void 0:t.id))}}),a.createElement("button",{type:"submit",disabled:!e.state.hasItemsLoaded||r||d,onClick:function(){d||e.nextPage(u)},className:"btn btn-outline-primary btn-form float-right btn-xs"},a.createElement(F.A,{id:"react.stockMovement.button.generatePicklist.label",defaultMessage:"Generate Picklist"})))))}})}}])&&B(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i}(a.Component);const ae=(0,g.withRouter)((0,s.Ng)((function(e){return{reasonCodes:e.reasonCodes.data,translate:(0,F.H)((0,o.ro)(e.localize)),stockMovementTranslationsFetched:e.session.fetchedTranslations.stockMovement,isPaginated:e.session.isPaginated,pageSize:e.session.pageSize,supportedActivities:e.session.supportedActivities,currentLocale:e.session.activeLanguage,currentUser:e.session.user,currentLocation:e.session.currentLocation}}),{fetchReasonCodes:l.xH,showSpinner:l.xc,hideSpinner:l.W$})(ne));ne.propTypes={initialValues:r().shape({}).isRequired,nextPage:r().func.isRequired,showSpinner:r().func.isRequired,hideSpinner:r().func.isRequired,fetchReasonCodes:r().func.isRequired,reasonCodes:r().arrayOf(r().shape({})).isRequired,translate:r().func.isRequired,stockMovementTranslationsFetched:r().bool.isRequired,isPaginated:r().bool.isRequired,showOnly:r().bool.isRequired,pageSize:r().number.isRequired,supportedActivities:r().arrayOf(r().string).isRequired,currentLocale:r().string.isRequired,currentUser:r().shape({id:r().string.isRequired}).isRequired,history:r().shape({push:r().func}).isRequired,currentLocation:r().shape({id:r().string.isRequired,name:r().string.isRequired}).isRequired};var ie=n(80461),re=n(39802),oe=n(91019);function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function de(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,be(a.key),a)}}function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ce=function(){return!!e})()}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}function me(e,t){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},me(e,t)}function pe(e,t,n){return(t=be(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e){var t=function(e){if("object"!=se(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==se(t)?t:t+""}var ve=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),pe(n=function(e,t,n){return t=fe(t),function(e,t){if(t&&("object"==se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ce()?Reflect.construct(t,n||[],fe(e).constructor):t.apply(e,n))}(this,t,[e]),"dataFetched",!1),n.state={values:n.props.initialValues,currentPage:1},n.updateWizardValues=n.updateWizardValues.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(t,e),n=t,(i=[{key:"componentDidMount",value:function(){this.props.fetchTranslations("","stockMovement"),this.props.stockMovementTranslationsFetched&&(this.dataFetched=!0,this.fetchInitialValues())}},{key:"componentWillReceiveProps",value:function(e){this.props.locale&&this.props.locale!==e.locale&&this.props.fetchTranslations(e.locale,"stockMovement"),e.stockMovementTranslationsFetched&&!this.dataFetched&&(this.dataFetched=!0,this.fetchInitialValues())}},{key:"stepList",get:function(){return this.props.hasPackingSupport?[this.props.translate("react.stockMovement.edit.label","Edit"),this.props.translate("react.stockMovement.pick.label","Pick"),this.props.translate("react.stockMovement.pack.label","Pack"),this.props.translate("react.stockMovement.send.label","Send")]:[this.props.translate("react.stockMovement.edit.label","Edit"),this.props.translate("react.stockMovement.pick.label","Pick"),this.props.translate("react.stockMovement.send.label","Send")]}},{key:"pageList",get:function(){return this.props.hasPackingSupport?[ae,d.A,u.A,c.A]:[ae,d.A,c.A]}},{key:"wizardTitle",get:function(){var e=this.state.values;return e.movementNumber||e.trackingNumber?[{text:this.props.translate("react.stockMovement.label","Stock Movement"),color:"#000000",delimeter:" | "},{text:e.movementNumber,color:"#000000",delimeter:" - "},{text:e.origin.name,color:"#004d40",delimeter:" ".concat(this.props.translate("react.default.to.label","to")," ")},{text:e.destination.name,color:"#01579b",delimeter:", "},{text:this.props.formatLocalizedDate(e.dateRequested,re.A.COMMON),color:"#4a148c",delimeter:", "},{text:e.description,color:"#770838",delimeter:""}]:[]}},{key:"additionalWizardTitle",get:function(){var e=this.state,t=e.currentPage,n=e.values,i=n.shipped?"SHIPPED":"",r=n.received?"RECEIVED":"";return this.props.hasPackingSupport&&4===t||!this.props.hasPackingSupport&&3===t?a.createElement("span",{className:"shipment-status float-right"},"".concat(i||r||"PENDING")):null}},{key:"updateWizardValues",value:function(e,t){this.setState({currentPage:e,values:t})}},{key:"fetchInitialValues",value:function(){var e=this;if(this.props.match.params.stockMovementId){this.props.showSpinner();var t="/api/stockMovements/".concat(this.props.match.params.stockMovementId);T.Ay.get(t).then((function(t){var n=t.data.data,a=n.origin.locationType,i=n.destination.locationType,r=ue(ue({},n),{},{stockMovementId:n.id,movementNumber:n.identifier,origin:{id:n.origin.id,type:a?a.locationTypeCode:null,name:n.origin.name,label:"".concat(n.origin.name," [").concat(a?a.description:null,"]")},destination:{id:n.destination.id,type:i?i.locationTypeCode:null,name:n.destination.name,label:"".concat(n.destination.name," [").concat(i?i.description:null,"]")},requestedBy:{id:n.requestedBy.id,name:n.requestedBy.name,label:n.requestedBy.name},requestType:{name:n.requestType.name,label:n.requestType.name}}),o=1;switch(r.statusCode){case"REQUESTED":case"VALIDATING":case"PENDING_APPROVAL":case"APPROVED":case"REJECTED":break;case"VALIDATED":case"PICKING":o=2;break;case"PICKED":case"PACKING":o=3;break;default:o=e.props.hasPackingSupport?4:3}e.setState({values:r,currentPage:o})})).catch((function(){return e.props.hideSpinner()}))}}},{key:"render",value:function(){var e=this.state,t=e.values,n=e.currentPage,i=this.props,r=i.currentLocation,o=i.currentUser,s=t.origin&&t.origin.id!==r.id||(null==t?void 0:t.isElectronicType)&&!(0,V.A)(o,t,r)||t.statusCode===N.A.PENDING_APPROVAL;return t.stockMovementId?a.createElement(ie.A,{pageList:this.pageList,stepList:this.stepList,initialValues:t,title:this.wizardTitle,additionalTitle:this.additionalWizardTitle,currentPage:n,prevPage:1===n?1:n-1,updateWizardValues:this.updateWizardValues,additionalProps:{showOnly:s}}):null}}])&&de(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i}(a.Component);const ye=(0,s.Ng)((function(e){return{locale:e.session.activeLanguage,stockMovementTranslationsFetched:e.session.fetchedTranslations.stockMovement,translate:(0,F.H)((0,o.ro)(e.localize)),hasPackingSupport:e.session.currentLocation.hasPackingSupport,currentLocation:e.session.currentLocation,currentUser:e.session.user,formatLocalizedDate:(0,oe.Yq)(e.localize)}}),{showSpinner:l.xc,hideSpinner:l.W$,fetchTranslations:l.dj})(ve);ve.propTypes={match:r().shape({params:r().shape({stockMovementId:r().string})}).isRequired,showSpinner:r().func.isRequired,hideSpinner:r().func.isRequired,locale:r().string.isRequired,stockMovementTranslationsFetched:r().bool.isRequired,fetchTranslations:r().func.isRequired,translate:r().func.isRequired,hasPackingSupport:r().bool.isRequired,currentLocation:r().shape({id:r().string}).isRequired,initialValues:r().shape({shipmentStatus:r().string}),currentUser:r().shape({id:r().string.isRequired}).isRequired,formatLocalizedDate:r().func.isRequired},ve.defaultProps={initialValues:{}}}}]);
//# sourceMappingURL=bundle.929af1b45eb780bfc503.8901.js.map